import { Debug } from '../../core/debug.js';
import { Vec4 } from '../../core/math/vec4.js';
import { Mat4 } from '../../core/math/mat4.js';
import { CULLFACE_NONE } from '../../platform/graphics/constants.js';
import { DebugGraphics } from '../../platform/graphics/debug-graphics.js';
import { LIGHTTYPE_DIRECTIONAL, LIGHTTYPE_OMNI } from '../constants.js';
import { createShaderFromCode } from '../shader-lib/utils.js';
import { LightCamera } from './light-camera.js';
import { BlendState } from '../../platform/graphics/blend-state.js';
import { QuadRender } from '../graphics/quad-render.js';
import { DepthState } from '../../platform/graphics/depth-state.js';
import { RenderPass } from '../../platform/graphics/render-pass.js';

const textureBlitVertexShader = /* glsl */`
    attribute vec2 vertex_position;
    varying vec2 uv0;
    void main(void) {
        gl_Position = vec4(vertex_position, 0.5, 1.0);
        uv0 = vertex_position.xy * 0.5 + 0.5;
        #ifndef WEBGPU
            uv0.y = 1.0 - uv0.y;
        #endif
    }`;
const textureBlitFragmentShader = /* glsl */`
    varying vec2 uv0;
    uniform sampler2D blitTexture;
    void main(void) {
        gl_FragColor = texture2D(blitTexture, uv0);
    }`;

// shader runs for each face, with inViewProj matrix representing a face camera
const textureCubeBlitFragmentShader = /* glsl */`
    varying vec2 uv0;
    uniform samplerCube blitTexture;
    uniform mat4 invViewProj;
    void main(void) {
        vec4 projPos = vec4(uv0 * 2.0 - 1.0, 0.5, 1.0);
        vec4 worldPos = invViewProj * projPos;
        gl_FragColor = textureCube(blitTexture, worldPos.xyz);
    }`;
const _viewport = new Vec4();

// for rendering of cookies, store inverse view projection matrices for 6 faces, allowing cubemap faces to be copied into the atlas
const _invViewProjMatrices = [];

/**
 * A render pass used to render cookie textures (both 2D and Cubemap) into the texture atlas.
 *
 * @ignore
 */
class RenderPassCookieRenderer extends RenderPass {
  constructor(device, cubeSlotsOffsets) {
    super(device);
    /** @type {QuadRender|null} */
    this._quadRenderer2D = null;
    /** @type {QuadRender|null} */
    this._quadRendererCube = null;
    this._filteredLights = [];
    this._cubeSlotsOffsets = cubeSlotsOffsets;
    this.requiresCubemaps = false;
    this.blitTextureId = device.scope.resolve('blitTexture');
    this.invViewProjId = device.scope.resolve('invViewProj');
  }
  destroy() {
    var _this$_quadRenderer2D, _this$_quadRendererCu;
    (_this$_quadRenderer2D = this._quadRenderer2D) == null || _this$_quadRenderer2D.destroy();
    this._quadRenderer2D = null;
    (_this$_quadRendererCu = this._quadRendererCube) == null || _this$_quadRendererCu.destroy();
    this._quadRendererCube = null;
  }
  static create(renderTarget, cubeSlotsOffsets) {
    Debug.assert(renderTarget);

    // prepare a single render pass to render all quads to the render target
    const renderPass = new RenderPassCookieRenderer(renderTarget.device, cubeSlotsOffsets);
    renderPass.init(renderTarget);
    renderPass.colorOps.clear = false;
    renderPass.depthStencilOps.clearDepth = false;
    return renderPass;
  }
  update(lights) {
    // pick lights we need to update the cookies for
    const filteredLights = this._filteredLights;
    this.filter(lights, filteredLights);

    // enabled / disable the pass
    this.executeEnabled = filteredLights.length > 0;
  }
  filter(lights, filteredLights) {
    for (let i = 0; i < lights.length; i++) {
      const light = lights[i];

      // skip directional lights
      if (light._type === LIGHTTYPE_DIRECTIONAL) continue;

      // skip clustered cookies with no assigned atlas slot
      if (!light.atlasViewportAllocated) continue;

      // only render cookie when the slot is reassigned (assuming the cookie texture is static)
      if (!light.atlasSlotUpdated) continue;
      if (light.enabled && light.cookie && light.visibleThisFrame) {
        filteredLights.push(light);
      }
    }
  }
  initInvViewProjMatrices() {
    if (!_invViewProjMatrices.length) {
      for (let face = 0; face < 6; face++) {
        const camera = LightCamera.create(null, LIGHTTYPE_OMNI, face);
        const projMat = camera.projectionMatrix;
        const viewMat = camera.node.getLocalTransform().clone().invert();
        _invViewProjMatrices[face] = new Mat4().mul2(projMat, viewMat).invert();
      }
    }
  }
  get quadRenderer2D() {
    if (!this._quadRenderer2D) {
      const shader = createShaderFromCode(this.device, textureBlitVertexShader, textureBlitFragmentShader, `cookieRenderer2d`);
      this._quadRenderer2D = new QuadRender(shader);
    }
    return this._quadRenderer2D;
  }
  get quadRendererCube() {
    if (!this._quadRendererCube) {
      const shader = createShaderFromCode(this.device, textureBlitVertexShader, textureCubeBlitFragmentShader, `cookieRendererCube`);
      this._quadRendererCube = new QuadRender(shader);
    }
    return this._quadRendererCube;
  }
  execute() {
    // render state
    const device = this.device;
    device.setBlendState(BlendState.NOBLEND);
    device.setCullMode(CULLFACE_NONE);
    device.setDepthState(DepthState.NODEPTH);
    device.setStencilState();
    const renderTargetWidth = this.renderTarget.colorBuffer.width;
    const cubeSlotsOffsets = this._cubeSlotsOffsets;
    const filteredLights = this._filteredLights;
    for (let i = 0; i < filteredLights.length; i++) {
      const light = filteredLights[i];
      DebugGraphics.pushGpuMarker(this.device, `COOKIE ${light._node.name}`);
      const faceCount = light.numShadowFaces;
      const quad = faceCount > 1 ? this.quadRendererCube : this.quadRenderer2D;
      if (faceCount > 1) {
        this.initInvViewProjMatrices();
      }

      // source texture
      this.blitTextureId.setValue(light.cookie);

      // render it to a viewport of the target
      for (let face = 0; face < faceCount; face++) {
        _viewport.copy(light.atlasViewport);
        if (faceCount > 1) {
          // for cubemap, render to one of the 3x3 sub-areas
          const smallSize = _viewport.z / 3;
          const offset = cubeSlotsOffsets[face];
          _viewport.x += smallSize * offset.x;
          _viewport.y += smallSize * offset.y;
          _viewport.z = smallSize;
          _viewport.w = smallSize;

          // cubemap face projection uniform
          this.invViewProjId.setValue(_invViewProjMatrices[face].data);
        }
        _viewport.mulScalar(renderTargetWidth);
        quad.render(_viewport);
      }
      DebugGraphics.popGpuMarker(device);
    }
    filteredLights.length = 0;
  }
}

export { RenderPassCookieRenderer };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyLXBhc3MtY29va2llLXJlbmRlcmVyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvc2NlbmUvcmVuZGVyZXIvcmVuZGVyLXBhc3MtY29va2llLXJlbmRlcmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5pbXBvcnQgeyBWZWM0IH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoL3ZlYzQuanMnO1xuaW1wb3J0IHsgTWF0NCB9IGZyb20gJy4uLy4uL2NvcmUvbWF0aC9tYXQ0LmpzJztcbmltcG9ydCB7IENVTExGQUNFX05PTkUgfSBmcm9tICcuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgRGVidWdHcmFwaGljcyB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL2RlYnVnLWdyYXBoaWNzLmpzJztcbmltcG9ydCB7IExJR0hUVFlQRV9ESVJFQ1RJT05BTCwgTElHSFRUWVBFX09NTkkgfSBmcm9tICcuLi9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgY3JlYXRlU2hhZGVyRnJvbUNvZGUgfSBmcm9tICcuLi9zaGFkZXItbGliL3V0aWxzLmpzJztcbmltcG9ydCB7IExpZ2h0Q2FtZXJhIH0gZnJvbSAnLi9saWdodC1jYW1lcmEuanMnO1xuaW1wb3J0IHsgQmxlbmRTdGF0ZSB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL2JsZW5kLXN0YXRlLmpzJztcbmltcG9ydCB7IFF1YWRSZW5kZXIgfSBmcm9tICcuLi9ncmFwaGljcy9xdWFkLXJlbmRlci5qcyc7XG5pbXBvcnQgeyBEZXB0aFN0YXRlIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvZGVwdGgtc3RhdGUuanMnO1xuaW1wb3J0IHsgUmVuZGVyUGFzcyB9IGZyb20gXCIuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9yZW5kZXItcGFzcy5qc1wiO1xuXG5jb25zdCB0ZXh0dXJlQmxpdFZlcnRleFNoYWRlciA9IC8qIGdsc2wgKi8gYFxuICAgIGF0dHJpYnV0ZSB2ZWMyIHZlcnRleF9wb3NpdGlvbjtcbiAgICB2YXJ5aW5nIHZlYzIgdXYwO1xuICAgIHZvaWQgbWFpbih2b2lkKSB7XG4gICAgICAgIGdsX1Bvc2l0aW9uID0gdmVjNCh2ZXJ0ZXhfcG9zaXRpb24sIDAuNSwgMS4wKTtcbiAgICAgICAgdXYwID0gdmVydGV4X3Bvc2l0aW9uLnh5ICogMC41ICsgMC41O1xuICAgICAgICAjaWZuZGVmIFdFQkdQVVxuICAgICAgICAgICAgdXYwLnkgPSAxLjAgLSB1djAueTtcbiAgICAgICAgI2VuZGlmXG4gICAgfWA7XG5cbmNvbnN0IHRleHR1cmVCbGl0RnJhZ21lbnRTaGFkZXIgPSAvKiBnbHNsICovIGBcbiAgICB2YXJ5aW5nIHZlYzIgdXYwO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIGJsaXRUZXh0dXJlO1xuICAgIHZvaWQgbWFpbih2b2lkKSB7XG4gICAgICAgIGdsX0ZyYWdDb2xvciA9IHRleHR1cmUyRChibGl0VGV4dHVyZSwgdXYwKTtcbiAgICB9YDtcblxuLy8gc2hhZGVyIHJ1bnMgZm9yIGVhY2ggZmFjZSwgd2l0aCBpblZpZXdQcm9qIG1hdHJpeCByZXByZXNlbnRpbmcgYSBmYWNlIGNhbWVyYVxuY29uc3QgdGV4dHVyZUN1YmVCbGl0RnJhZ21lbnRTaGFkZXIgPSAvKiBnbHNsICovIGBcbiAgICB2YXJ5aW5nIHZlYzIgdXYwO1xuICAgIHVuaWZvcm0gc2FtcGxlckN1YmUgYmxpdFRleHR1cmU7XG4gICAgdW5pZm9ybSBtYXQ0IGludlZpZXdQcm9qO1xuICAgIHZvaWQgbWFpbih2b2lkKSB7XG4gICAgICAgIHZlYzQgcHJvalBvcyA9IHZlYzQodXYwICogMi4wIC0gMS4wLCAwLjUsIDEuMCk7XG4gICAgICAgIHZlYzQgd29ybGRQb3MgPSBpbnZWaWV3UHJvaiAqIHByb2pQb3M7XG4gICAgICAgIGdsX0ZyYWdDb2xvciA9IHRleHR1cmVDdWJlKGJsaXRUZXh0dXJlLCB3b3JsZFBvcy54eXopO1xuICAgIH1gO1xuXG5jb25zdCBfdmlld3BvcnQgPSBuZXcgVmVjNCgpO1xuXG4vLyBmb3IgcmVuZGVyaW5nIG9mIGNvb2tpZXMsIHN0b3JlIGludmVyc2UgdmlldyBwcm9qZWN0aW9uIG1hdHJpY2VzIGZvciA2IGZhY2VzLCBhbGxvd2luZyBjdWJlbWFwIGZhY2VzIHRvIGJlIGNvcGllZCBpbnRvIHRoZSBhdGxhc1xuY29uc3QgX2ludlZpZXdQcm9qTWF0cmljZXMgPSBbXTtcblxuLyoqXG4gKiBBIHJlbmRlciBwYXNzIHVzZWQgdG8gcmVuZGVyIGNvb2tpZSB0ZXh0dXJlcyAoYm90aCAyRCBhbmQgQ3ViZW1hcCkgaW50byB0aGUgdGV4dHVyZSBhdGxhcy5cbiAqXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIFJlbmRlclBhc3NDb29raWVSZW5kZXJlciBleHRlbmRzIFJlbmRlclBhc3Mge1xuICAgIC8qKiBAdHlwZSB7UXVhZFJlbmRlcnxudWxsfSAqL1xuICAgIF9xdWFkUmVuZGVyZXIyRCA9IG51bGw7XG5cbiAgICAvKiogQHR5cGUge1F1YWRSZW5kZXJ8bnVsbH0gKi9cbiAgICBfcXVhZFJlbmRlcmVyQ3ViZSA9IG51bGw7XG5cbiAgICBfZmlsdGVyZWRMaWdodHMgPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKGRldmljZSwgY3ViZVNsb3RzT2Zmc2V0cykge1xuICAgICAgICBzdXBlcihkZXZpY2UpO1xuICAgICAgICB0aGlzLl9jdWJlU2xvdHNPZmZzZXRzID0gY3ViZVNsb3RzT2Zmc2V0cztcblxuICAgICAgICB0aGlzLnJlcXVpcmVzQ3ViZW1hcHMgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLmJsaXRUZXh0dXJlSWQgPSBkZXZpY2Uuc2NvcGUucmVzb2x2ZSgnYmxpdFRleHR1cmUnKTtcbiAgICAgICAgdGhpcy5pbnZWaWV3UHJvaklkID0gZGV2aWNlLnNjb3BlLnJlc29sdmUoJ2ludlZpZXdQcm9qJyk7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5fcXVhZFJlbmRlcmVyMkQ/LmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fcXVhZFJlbmRlcmVyMkQgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3F1YWRSZW5kZXJlckN1YmU/LmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fcXVhZFJlbmRlcmVyQ3ViZSA9IG51bGw7XG4gICAgfVxuXG4gICAgc3RhdGljIGNyZWF0ZShyZW5kZXJUYXJnZXQsIGN1YmVTbG90c09mZnNldHMpIHtcblxuICAgICAgICBEZWJ1Zy5hc3NlcnQocmVuZGVyVGFyZ2V0KTtcblxuICAgICAgICAvLyBwcmVwYXJlIGEgc2luZ2xlIHJlbmRlciBwYXNzIHRvIHJlbmRlciBhbGwgcXVhZHMgdG8gdGhlIHJlbmRlciB0YXJnZXRcbiAgICAgICAgY29uc3QgcmVuZGVyUGFzcyA9IG5ldyBSZW5kZXJQYXNzQ29va2llUmVuZGVyZXIocmVuZGVyVGFyZ2V0LmRldmljZSwgY3ViZVNsb3RzT2Zmc2V0cyk7XG4gICAgICAgIHJlbmRlclBhc3MuaW5pdChyZW5kZXJUYXJnZXQpO1xuICAgICAgICByZW5kZXJQYXNzLmNvbG9yT3BzLmNsZWFyID0gZmFsc2U7XG4gICAgICAgIHJlbmRlclBhc3MuZGVwdGhTdGVuY2lsT3BzLmNsZWFyRGVwdGggPSBmYWxzZTtcblxuICAgICAgICByZXR1cm4gcmVuZGVyUGFzcztcbiAgICB9XG5cbiAgICB1cGRhdGUobGlnaHRzKSB7XG5cbiAgICAgICAgLy8gcGljayBsaWdodHMgd2UgbmVlZCB0byB1cGRhdGUgdGhlIGNvb2tpZXMgZm9yXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkTGlnaHRzID0gdGhpcy5fZmlsdGVyZWRMaWdodHM7XG4gICAgICAgIHRoaXMuZmlsdGVyKGxpZ2h0cywgZmlsdGVyZWRMaWdodHMpO1xuXG4gICAgICAgIC8vIGVuYWJsZWQgLyBkaXNhYmxlIHRoZSBwYXNzXG4gICAgICAgIHRoaXMuZXhlY3V0ZUVuYWJsZWQgPSBmaWx0ZXJlZExpZ2h0cy5sZW5ndGggPiAwO1xuICAgIH1cblxuICAgIGZpbHRlcihsaWdodHMsIGZpbHRlcmVkTGlnaHRzKSB7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaWdodHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpZ2h0ID0gbGlnaHRzW2ldO1xuXG4gICAgICAgICAgICAvLyBza2lwIGRpcmVjdGlvbmFsIGxpZ2h0c1xuICAgICAgICAgICAgaWYgKGxpZ2h0Ll90eXBlID09PSBMSUdIVFRZUEVfRElSRUNUSU9OQUwpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIC8vIHNraXAgY2x1c3RlcmVkIGNvb2tpZXMgd2l0aCBubyBhc3NpZ25lZCBhdGxhcyBzbG90XG4gICAgICAgICAgICBpZiAoIWxpZ2h0LmF0bGFzVmlld3BvcnRBbGxvY2F0ZWQpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIC8vIG9ubHkgcmVuZGVyIGNvb2tpZSB3aGVuIHRoZSBzbG90IGlzIHJlYXNzaWduZWQgKGFzc3VtaW5nIHRoZSBjb29raWUgdGV4dHVyZSBpcyBzdGF0aWMpXG4gICAgICAgICAgICBpZiAoIWxpZ2h0LmF0bGFzU2xvdFVwZGF0ZWQpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGlmIChsaWdodC5lbmFibGVkICYmIGxpZ2h0LmNvb2tpZSAmJiBsaWdodC52aXNpYmxlVGhpc0ZyYW1lKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRMaWdodHMucHVzaChsaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbml0SW52Vmlld1Byb2pNYXRyaWNlcygpIHtcbiAgICAgICAgaWYgKCFfaW52Vmlld1Byb2pNYXRyaWNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgNjsgZmFjZSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FtZXJhID0gTGlnaHRDYW1lcmEuY3JlYXRlKG51bGwsIExJR0hUVFlQRV9PTU5JLCBmYWNlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9qTWF0ID0gY2FtZXJhLnByb2plY3Rpb25NYXRyaXg7XG4gICAgICAgICAgICAgICAgY29uc3Qgdmlld01hdCA9IGNhbWVyYS5ub2RlLmdldExvY2FsVHJhbnNmb3JtKCkuY2xvbmUoKS5pbnZlcnQoKTtcbiAgICAgICAgICAgICAgICBfaW52Vmlld1Byb2pNYXRyaWNlc1tmYWNlXSA9IG5ldyBNYXQ0KCkubXVsMihwcm9qTWF0LCB2aWV3TWF0KS5pbnZlcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBxdWFkUmVuZGVyZXIyRCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9xdWFkUmVuZGVyZXIyRCkge1xuICAgICAgICAgICAgY29uc3Qgc2hhZGVyID0gY3JlYXRlU2hhZGVyRnJvbUNvZGUodGhpcy5kZXZpY2UsIHRleHR1cmVCbGl0VmVydGV4U2hhZGVyLCB0ZXh0dXJlQmxpdEZyYWdtZW50U2hhZGVyLCBgY29va2llUmVuZGVyZXIyZGApO1xuICAgICAgICAgICAgdGhpcy5fcXVhZFJlbmRlcmVyMkQgPSBuZXcgUXVhZFJlbmRlcihzaGFkZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9xdWFkUmVuZGVyZXIyRDtcbiAgICB9XG5cbiAgICBnZXQgcXVhZFJlbmRlcmVyQ3ViZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9xdWFkUmVuZGVyZXJDdWJlKSB7XG4gICAgICAgICAgICBjb25zdCBzaGFkZXIgPSBjcmVhdGVTaGFkZXJGcm9tQ29kZSh0aGlzLmRldmljZSwgdGV4dHVyZUJsaXRWZXJ0ZXhTaGFkZXIsIHRleHR1cmVDdWJlQmxpdEZyYWdtZW50U2hhZGVyLCBgY29va2llUmVuZGVyZXJDdWJlYCk7XG4gICAgICAgICAgICB0aGlzLl9xdWFkUmVuZGVyZXJDdWJlID0gbmV3IFF1YWRSZW5kZXIoc2hhZGVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcXVhZFJlbmRlcmVyQ3ViZTtcbiAgICB9XG5cbiAgICBleGVjdXRlKCkge1xuXG4gICAgICAgIC8vIHJlbmRlciBzdGF0ZVxuICAgICAgICBjb25zdCBkZXZpY2UgPSB0aGlzLmRldmljZTtcbiAgICAgICAgZGV2aWNlLnNldEJsZW5kU3RhdGUoQmxlbmRTdGF0ZS5OT0JMRU5EKTtcbiAgICAgICAgZGV2aWNlLnNldEN1bGxNb2RlKENVTExGQUNFX05PTkUpO1xuICAgICAgICBkZXZpY2Uuc2V0RGVwdGhTdGF0ZShEZXB0aFN0YXRlLk5PREVQVEgpO1xuICAgICAgICBkZXZpY2Uuc2V0U3RlbmNpbFN0YXRlKCk7XG5cbiAgICAgICAgY29uc3QgcmVuZGVyVGFyZ2V0V2lkdGggPSB0aGlzLnJlbmRlclRhcmdldC5jb2xvckJ1ZmZlci53aWR0aDtcbiAgICAgICAgY29uc3QgY3ViZVNsb3RzT2Zmc2V0cyA9IHRoaXMuX2N1YmVTbG90c09mZnNldHM7XG5cbiAgICAgICAgY29uc3QgZmlsdGVyZWRMaWdodHMgPSB0aGlzLl9maWx0ZXJlZExpZ2h0cztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWx0ZXJlZExpZ2h0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGlnaHQgPSBmaWx0ZXJlZExpZ2h0c1tpXTtcblxuICAgICAgICAgICAgRGVidWdHcmFwaGljcy5wdXNoR3B1TWFya2VyKHRoaXMuZGV2aWNlLCBgQ09PS0lFICR7bGlnaHQuX25vZGUubmFtZX1gKTtcblxuICAgICAgICAgICAgY29uc3QgZmFjZUNvdW50ID0gbGlnaHQubnVtU2hhZG93RmFjZXM7XG4gICAgICAgICAgICBjb25zdCBxdWFkID0gZmFjZUNvdW50ID4gMSA/IHRoaXMucXVhZFJlbmRlcmVyQ3ViZSA6IHRoaXMucXVhZFJlbmRlcmVyMkQ7XG5cbiAgICAgICAgICAgIGlmIChmYWNlQ291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0SW52Vmlld1Byb2pNYXRyaWNlcygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzb3VyY2UgdGV4dHVyZVxuICAgICAgICAgICAgdGhpcy5ibGl0VGV4dHVyZUlkLnNldFZhbHVlKGxpZ2h0LmNvb2tpZSk7XG5cbiAgICAgICAgICAgIC8vIHJlbmRlciBpdCB0byBhIHZpZXdwb3J0IG9mIHRoZSB0YXJnZXRcbiAgICAgICAgICAgIGZvciAobGV0IGZhY2UgPSAwOyBmYWNlIDwgZmFjZUNvdW50OyBmYWNlKyspIHtcblxuICAgICAgICAgICAgICAgIF92aWV3cG9ydC5jb3B5KGxpZ2h0LmF0bGFzVmlld3BvcnQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZhY2VDb3VudCA+IDEpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgY3ViZW1hcCwgcmVuZGVyIHRvIG9uZSBvZiB0aGUgM3gzIHN1Yi1hcmVhc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzbWFsbFNpemUgPSBfdmlld3BvcnQueiAvIDM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGN1YmVTbG90c09mZnNldHNbZmFjZV07XG4gICAgICAgICAgICAgICAgICAgIF92aWV3cG9ydC54ICs9IHNtYWxsU2l6ZSAqIG9mZnNldC54O1xuICAgICAgICAgICAgICAgICAgICBfdmlld3BvcnQueSArPSBzbWFsbFNpemUgKiBvZmZzZXQueTtcbiAgICAgICAgICAgICAgICAgICAgX3ZpZXdwb3J0LnogPSBzbWFsbFNpemU7XG4gICAgICAgICAgICAgICAgICAgIF92aWV3cG9ydC53ID0gc21hbGxTaXplO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGN1YmVtYXAgZmFjZSBwcm9qZWN0aW9uIHVuaWZvcm1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZWaWV3UHJvaklkLnNldFZhbHVlKF9pbnZWaWV3UHJvak1hdHJpY2VzW2ZhY2VdLmRhdGEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF92aWV3cG9ydC5tdWxTY2FsYXIocmVuZGVyVGFyZ2V0V2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgcXVhZC5yZW5kZXIoX3ZpZXdwb3J0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgRGVidWdHcmFwaGljcy5wb3BHcHVNYXJrZXIoZGV2aWNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZpbHRlcmVkTGlnaHRzLmxlbmd0aCA9IDA7XG4gICAgfVxufVxuXG5leHBvcnQgeyBSZW5kZXJQYXNzQ29va2llUmVuZGVyZXIgfTtcbiJdLCJuYW1lcyI6WyJ0ZXh0dXJlQmxpdFZlcnRleFNoYWRlciIsInRleHR1cmVCbGl0RnJhZ21lbnRTaGFkZXIiLCJ0ZXh0dXJlQ3ViZUJsaXRGcmFnbWVudFNoYWRlciIsIl92aWV3cG9ydCIsIlZlYzQiLCJfaW52Vmlld1Byb2pNYXRyaWNlcyIsIlJlbmRlclBhc3NDb29raWVSZW5kZXJlciIsIlJlbmRlclBhc3MiLCJjb25zdHJ1Y3RvciIsImRldmljZSIsImN1YmVTbG90c09mZnNldHMiLCJfcXVhZFJlbmRlcmVyMkQiLCJfcXVhZFJlbmRlcmVyQ3ViZSIsIl9maWx0ZXJlZExpZ2h0cyIsIl9jdWJlU2xvdHNPZmZzZXRzIiwicmVxdWlyZXNDdWJlbWFwcyIsImJsaXRUZXh0dXJlSWQiLCJzY29wZSIsInJlc29sdmUiLCJpbnZWaWV3UHJvaklkIiwiZGVzdHJveSIsIl90aGlzJF9xdWFkUmVuZGVyZXIyRCIsIl90aGlzJF9xdWFkUmVuZGVyZXJDdSIsImNyZWF0ZSIsInJlbmRlclRhcmdldCIsIkRlYnVnIiwiYXNzZXJ0IiwicmVuZGVyUGFzcyIsImluaXQiLCJjb2xvck9wcyIsImNsZWFyIiwiZGVwdGhTdGVuY2lsT3BzIiwiY2xlYXJEZXB0aCIsInVwZGF0ZSIsImxpZ2h0cyIsImZpbHRlcmVkTGlnaHRzIiwiZmlsdGVyIiwiZXhlY3V0ZUVuYWJsZWQiLCJsZW5ndGgiLCJpIiwibGlnaHQiLCJfdHlwZSIsIkxJR0hUVFlQRV9ESVJFQ1RJT05BTCIsImF0bGFzVmlld3BvcnRBbGxvY2F0ZWQiLCJhdGxhc1Nsb3RVcGRhdGVkIiwiZW5hYmxlZCIsImNvb2tpZSIsInZpc2libGVUaGlzRnJhbWUiLCJwdXNoIiwiaW5pdEludlZpZXdQcm9qTWF0cmljZXMiLCJmYWNlIiwiY2FtZXJhIiwiTGlnaHRDYW1lcmEiLCJMSUdIVFRZUEVfT01OSSIsInByb2pNYXQiLCJwcm9qZWN0aW9uTWF0cml4Iiwidmlld01hdCIsIm5vZGUiLCJnZXRMb2NhbFRyYW5zZm9ybSIsImNsb25lIiwiaW52ZXJ0IiwiTWF0NCIsIm11bDIiLCJxdWFkUmVuZGVyZXIyRCIsInNoYWRlciIsImNyZWF0ZVNoYWRlckZyb21Db2RlIiwiUXVhZFJlbmRlciIsInF1YWRSZW5kZXJlckN1YmUiLCJleGVjdXRlIiwic2V0QmxlbmRTdGF0ZSIsIkJsZW5kU3RhdGUiLCJOT0JMRU5EIiwic2V0Q3VsbE1vZGUiLCJDVUxMRkFDRV9OT05FIiwic2V0RGVwdGhTdGF0ZSIsIkRlcHRoU3RhdGUiLCJOT0RFUFRIIiwic2V0U3RlbmNpbFN0YXRlIiwicmVuZGVyVGFyZ2V0V2lkdGgiLCJjb2xvckJ1ZmZlciIsIndpZHRoIiwiRGVidWdHcmFwaGljcyIsInB1c2hHcHVNYXJrZXIiLCJfbm9kZSIsIm5hbWUiLCJmYWNlQ291bnQiLCJudW1TaGFkb3dGYWNlcyIsInF1YWQiLCJzZXRWYWx1ZSIsImNvcHkiLCJhdGxhc1ZpZXdwb3J0Iiwic21hbGxTaXplIiwieiIsIm9mZnNldCIsIngiLCJ5IiwidyIsImRhdGEiLCJtdWxTY2FsYXIiLCJyZW5kZXIiLCJwb3BHcHVNYXJrZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFhQSxNQUFNQSx1QkFBdUIsYUFBZSxDQUFBO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFNLENBQUEsQ0FBQTtBQUVOLE1BQU1DLHlCQUF5QixhQUFlLENB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
