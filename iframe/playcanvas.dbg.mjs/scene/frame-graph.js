import { Debug } from '../core/debug.js';

/**
 * A frame graph represents a single rendering frame as a sequence of render passes.
 *
 * @ignore
 */
class FrameGraph {
  constructor() {
    /** @type {import('../platform/graphics/render-pass.js').RenderPass[]} */
    this.renderPasses = [];
    /**
     * Map used during frame graph compilation. It maps a render target to its previous occurrence.
     *
     *  @type {Map<import('../platform/graphics/render-target.js').RenderTarget, import('../platform/graphics/render-pass.js').RenderPass>}
     */
    this.renderTargetMap = new Map();
  }
  /**
   * Add a render pass to the frame.
   *
   * @param {import('../platform/graphics/render-pass.js').RenderPass} renderPass - The render
   * pass to add.
   */
  addRenderPass(renderPass) {
    Debug.assert(renderPass);
    renderPass.frameUpdate();
    const beforePasses = renderPass.beforePasses;
    for (let i = 0; i < beforePasses.length; i++) {
      const pass = beforePasses[i];
      if (pass.enabled) {
        this.addRenderPass(pass);
      }
    }
    if (renderPass.enabled) {
      this.renderPasses.push(renderPass);
    }
    const afterPasses = renderPass.afterPasses;
    for (let i = 0; i < afterPasses.length; i++) {
      const pass = afterPasses[i];
      if (pass.enabled) {
        this.addRenderPass(pass);
      }
    }
  }
  reset() {
    this.renderPasses.length = 0;
  }
  compile() {
    const renderTargetMap = this.renderTargetMap;
    const renderPasses = this.renderPasses;
    for (let i = 0; i < renderPasses.length; i++) {
      const renderPass = renderPasses[i];
      const renderTarget = renderPass.renderTarget;

      // if using a target, or null which represents the default back-buffer
      if (renderTarget !== undefined) {
        // previous pass using the same render target
        const prevPass = renderTargetMap.get(renderTarget);
        if (prevPass) {
          // if we use the RT without clearing, make sure the previous pass stores data
          const count = renderPass.colorArrayOps.length;
          for (let j = 0; j < count; j++) {
            const colorOps = renderPass.colorArrayOps[j];
            if (!colorOps.clear) {
              prevPass.colorArrayOps[j].store = true;
            }
          }
          if (!renderPass.depthStencilOps.clearDepth) {
            prevPass.depthStencilOps.storeDepth = true;
          }
          if (!renderPass.depthStencilOps.clearStencil) {
            prevPass.depthStencilOps.storeStencil = true;
          }
        }

        // add the pass to the map
        renderTargetMap.set(renderTarget, renderPass);
      }
    }

    // Walk over render passes to find passes rendering to the same cubemap texture.
    // If those passes are separated only by passes not requiring cubemap (shadows ..),
    // we skip the mipmap generation till the last rendering to the cubemap, to avoid
    // mipmaps being generated after each face.
    /** @type {import('../platform/graphics/texture.js').Texture} */
    let lastCubeTexture = null;
    /** @type {import('../platform/graphics/render-pass.js').RenderPass} */
    let lastCubeRenderPass = null;
    for (let i = 0; i < renderPasses.length; i++) {
      const renderPass = renderPasses[i];
      const renderTarget = renderPass.renderTarget;
      const thisTexture = renderTarget == null ? void 0 : renderTarget.colorBuffer;
      if (thisTexture != null && thisTexture.cubemap) {
        // if previous pass used the same cubemap texture, it does not need mipmaps generated
        if (lastCubeTexture === thisTexture) {
          const count = lastCubeRenderPass.colorArrayOps.length;
          for (let j = 0; j < count; j++) {
            lastCubeRenderPass.colorArrayOps[j].mipmaps = false;
          }
        }
        lastCubeTexture = renderTarget.colorBuffer;
        lastCubeRenderPass = renderPass;
      } else if (renderPass.requiresCubemaps) {
        // if the cubemap is required, break the cubemap rendering chain
        lastCubeTexture = null;
        lastCubeRenderPass = null;
      }
    }
    renderTargetMap.clear();
  }
  render(device) {
    this.compile();
    const renderPasses = this.renderPasses;
    for (let i = 0; i < renderPasses.length; i++) {
      renderPasses[i].render();
    }
  }
}

export { FrameGraph };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnJhbWUtZ3JhcGguanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9zY2VuZS9mcmFtZS1ncmFwaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uL2NvcmUvZGVidWcuanMnO1xuXG4vKipcbiAqIEEgZnJhbWUgZ3JhcGggcmVwcmVzZW50cyBhIHNpbmdsZSByZW5kZXJpbmcgZnJhbWUgYXMgYSBzZXF1ZW5jZSBvZiByZW5kZXIgcGFzc2VzLlxuICpcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgRnJhbWVHcmFwaCB7XG4gICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4uL3BsYXRmb3JtL2dyYXBoaWNzL3JlbmRlci1wYXNzLmpzJykuUmVuZGVyUGFzc1tdfSAqL1xuICAgIHJlbmRlclBhc3NlcyA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogTWFwIHVzZWQgZHVyaW5nIGZyYW1lIGdyYXBoIGNvbXBpbGF0aW9uLiBJdCBtYXBzIGEgcmVuZGVyIHRhcmdldCB0byBpdHMgcHJldmlvdXMgb2NjdXJyZW5jZS5cbiAgICAgKlxuICAgICAqICBAdHlwZSB7TWFwPGltcG9ydCgnLi4vcGxhdGZvcm0vZ3JhcGhpY3MvcmVuZGVyLXRhcmdldC5qcycpLlJlbmRlclRhcmdldCwgaW1wb3J0KCcuLi9wbGF0Zm9ybS9ncmFwaGljcy9yZW5kZXItcGFzcy5qcycpLlJlbmRlclBhc3M+fVxuICAgICAqL1xuICAgIHJlbmRlclRhcmdldE1hcCA9IG5ldyBNYXAoKTtcblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHJlbmRlciBwYXNzIHRvIHRoZSBmcmFtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9wbGF0Zm9ybS9ncmFwaGljcy9yZW5kZXItcGFzcy5qcycpLlJlbmRlclBhc3N9IHJlbmRlclBhc3MgLSBUaGUgcmVuZGVyXG4gICAgICogcGFzcyB0byBhZGQuXG4gICAgICovXG4gICAgYWRkUmVuZGVyUGFzcyhyZW5kZXJQYXNzKSB7XG4gICAgICAgIERlYnVnLmFzc2VydChyZW5kZXJQYXNzKTtcbiAgICAgICAgcmVuZGVyUGFzcy5mcmFtZVVwZGF0ZSgpO1xuXG4gICAgICAgIGNvbnN0IGJlZm9yZVBhc3NlcyA9IHJlbmRlclBhc3MuYmVmb3JlUGFzc2VzO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJlZm9yZVBhc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcGFzcyA9IGJlZm9yZVBhc3Nlc1tpXTtcbiAgICAgICAgICAgIGlmIChwYXNzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJlbmRlclBhc3MocGFzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVuZGVyUGFzcy5lbmFibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclBhc3Nlcy5wdXNoKHJlbmRlclBhc3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYWZ0ZXJQYXNzZXMgPSByZW5kZXJQYXNzLmFmdGVyUGFzc2VzO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFmdGVyUGFzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwYXNzID0gYWZ0ZXJQYXNzZXNbaV07XG4gICAgICAgICAgICBpZiAocGFzcy5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRSZW5kZXJQYXNzKHBhc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMucmVuZGVyUGFzc2VzLmxlbmd0aCA9IDA7XG4gICAgfVxuXG4gICAgY29tcGlsZSgpIHtcblxuICAgICAgICBjb25zdCByZW5kZXJUYXJnZXRNYXAgPSB0aGlzLnJlbmRlclRhcmdldE1hcDtcbiAgICAgICAgY29uc3QgcmVuZGVyUGFzc2VzID0gdGhpcy5yZW5kZXJQYXNzZXM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVyUGFzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJQYXNzID0gcmVuZGVyUGFzc2VzW2ldO1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyVGFyZ2V0ID0gcmVuZGVyUGFzcy5yZW5kZXJUYXJnZXQ7XG5cbiAgICAgICAgICAgIC8vIGlmIHVzaW5nIGEgdGFyZ2V0LCBvciBudWxsIHdoaWNoIHJlcHJlc2VudHMgdGhlIGRlZmF1bHQgYmFjay1idWZmZXJcbiAgICAgICAgICAgIGlmIChyZW5kZXJUYXJnZXQgIT09IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgLy8gcHJldmlvdXMgcGFzcyB1c2luZyB0aGUgc2FtZSByZW5kZXIgdGFyZ2V0XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldlBhc3MgPSByZW5kZXJUYXJnZXRNYXAuZ2V0KHJlbmRlclRhcmdldCk7XG4gICAgICAgICAgICAgICAgaWYgKHByZXZQYXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UgdXNlIHRoZSBSVCB3aXRob3V0IGNsZWFyaW5nLCBtYWtlIHN1cmUgdGhlIHByZXZpb3VzIHBhc3Mgc3RvcmVzIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY291bnQgPSByZW5kZXJQYXNzLmNvbG9yQXJyYXlPcHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNvdW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yT3BzID0gcmVuZGVyUGFzcy5jb2xvckFycmF5T3BzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb2xvck9wcy5jbGVhcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZQYXNzLmNvbG9yQXJyYXlPcHNbal0uc3RvcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVuZGVyUGFzcy5kZXB0aFN0ZW5jaWxPcHMuY2xlYXJEZXB0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldlBhc3MuZGVwdGhTdGVuY2lsT3BzLnN0b3JlRGVwdGggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVuZGVyUGFzcy5kZXB0aFN0ZW5jaWxPcHMuY2xlYXJTdGVuY2lsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2UGFzcy5kZXB0aFN0ZW5jaWxPcHMuc3RvcmVTdGVuY2lsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGFkZCB0aGUgcGFzcyB0byB0aGUgbWFwXG4gICAgICAgICAgICAgICAgcmVuZGVyVGFyZ2V0TWFwLnNldChyZW5kZXJUYXJnZXQsIHJlbmRlclBhc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2FsayBvdmVyIHJlbmRlciBwYXNzZXMgdG8gZmluZCBwYXNzZXMgcmVuZGVyaW5nIHRvIHRoZSBzYW1lIGN1YmVtYXAgdGV4dHVyZS5cbiAgICAgICAgLy8gSWYgdGhvc2UgcGFzc2VzIGFyZSBzZXBhcmF0ZWQgb25seSBieSBwYXNzZXMgbm90IHJlcXVpcmluZyBjdWJlbWFwIChzaGFkb3dzIC4uKSxcbiAgICAgICAgLy8gd2Ugc2tpcCB0aGUgbWlwbWFwIGdlbmVyYXRpb24gdGlsbCB0aGUgbGFzdCByZW5kZXJpbmcgdG8gdGhlIGN1YmVtYXAsIHRvIGF2b2lkXG4gICAgICAgIC8vIG1pcG1hcHMgYmVpbmcgZ2VuZXJhdGVkIGFmdGVyIGVhY2ggZmFjZS5cbiAgICAgICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4uL3BsYXRmb3JtL2dyYXBoaWNzL3RleHR1cmUuanMnKS5UZXh0dXJlfSAqL1xuICAgICAgICBsZXQgbGFzdEN1YmVUZXh0dXJlID0gbnVsbDtcbiAgICAgICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4uL3BsYXRmb3JtL2dyYXBoaWNzL3JlbmRlci1wYXNzLmpzJykuUmVuZGVyUGFzc30gKi9cbiAgICAgICAgbGV0IGxhc3RDdWJlUmVuZGVyUGFzcyA9IG51bGw7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVyUGFzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJQYXNzID0gcmVuZGVyUGFzc2VzW2ldO1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyVGFyZ2V0ID0gcmVuZGVyUGFzcy5yZW5kZXJUYXJnZXQ7XG4gICAgICAgICAgICBjb25zdCB0aGlzVGV4dHVyZSA9IHJlbmRlclRhcmdldD8uY29sb3JCdWZmZXI7XG5cbiAgICAgICAgICAgIGlmICh0aGlzVGV4dHVyZT8uY3ViZW1hcCkge1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgcHJldmlvdXMgcGFzcyB1c2VkIHRoZSBzYW1lIGN1YmVtYXAgdGV4dHVyZSwgaXQgZG9lcyBub3QgbmVlZCBtaXBtYXBzIGdlbmVyYXRlZFxuICAgICAgICAgICAgICAgIGlmIChsYXN0Q3ViZVRleHR1cmUgPT09IHRoaXNUZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gbGFzdEN1YmVSZW5kZXJQYXNzLmNvbG9yQXJyYXlPcHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNvdW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RDdWJlUmVuZGVyUGFzcy5jb2xvckFycmF5T3BzW2pdLm1pcG1hcHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxhc3RDdWJlVGV4dHVyZSA9IHJlbmRlclRhcmdldC5jb2xvckJ1ZmZlcjtcbiAgICAgICAgICAgICAgICBsYXN0Q3ViZVJlbmRlclBhc3MgPSByZW5kZXJQYXNzO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlbmRlclBhc3MucmVxdWlyZXNDdWJlbWFwcykge1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGN1YmVtYXAgaXMgcmVxdWlyZWQsIGJyZWFrIHRoZSBjdWJlbWFwIHJlbmRlcmluZyBjaGFpblxuICAgICAgICAgICAgICAgIGxhc3RDdWJlVGV4dHVyZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgbGFzdEN1YmVSZW5kZXJQYXNzID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlbmRlclRhcmdldE1hcC5jbGVhcigpO1xuICAgIH1cblxuICAgIHJlbmRlcihkZXZpY2UpIHtcblxuICAgICAgICB0aGlzLmNvbXBpbGUoKTtcblxuICAgICAgICBjb25zdCByZW5kZXJQYXNzZXMgPSB0aGlzLnJlbmRlclBhc3NlcztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW5kZXJQYXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJlbmRlclBhc3Nlc1tpXS5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgRnJhbWVHcmFwaCB9O1xuIl0sIm5hbWVzIjpbIkZyYW1lR3JhcGgiLCJjb25zdHJ1Y3RvciIsInJlbmRlclBhc3NlcyIsInJlbmRlclRhcmdldE1hcCIsIk1hcCIsImFkZFJlbmRlclBhc3MiLCJyZW5kZXJQYXNzIiwiRGVidWciLCJhc3NlcnQiLCJmcmFtZVVwZGF0ZSIsImJlZm9yZVBhc3NlcyIsImkiLCJsZW5ndGgiLCJwYXNzIiwiZW5hYmxlZCIsInB1c2giLCJhZnRlclBhc3NlcyIsInJlc2V0IiwiY29tcGlsZSIsInJlbmRlclRhcmdldCIsInVuZGVmaW5lZCIsInByZXZQYXNzIiwiZ2V0IiwiY291bnQiLCJjb2xvckFycmF5T3BzIiwiaiIsImNvbG9yT3BzIiwiY2xlYXIiLCJzdG9yZSIsImRlcHRoU3RlbmNpbE9wcyIsImNsZWFyRGVwdGgiLCJzdG9yZURlcHRoIiwiY2xlYXJTdGVuY2lsIiwic3RvcmVTdGVuY2lsIiwic2V0IiwibGFzdEN1YmVUZXh0dXJlIiwibGFzdEN1YmVSZW5kZXJQYXNzIiwidGhpc1RleHR1cmUiLCJjb2xvckJ1ZmZlciIsImN1YmVtYXAiLCJtaXBtYXBzIiwicmVxdWlyZXNDdWJlbWFwcyIsInJlbmRlciIsImRldmljZSJdLCJtYXBwaW5ncyI6Ijs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTUEsVUFBVSxDQUFDO0VBQUFDLFdBQUEsR0FBQTtBQUNiO0lBQUEsSUFDQUMsQ0FBQUEsWUFBWSxHQUFHLEVBQUUsQ0FBQTtBQUVqQjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBSkksSUFBQSxJQUFBLENBS0FDLGVBQWUsR0FBRyxJQUFJQyxHQUFHLEVBQUUsQ0FBQTtBQUFBLEdBQUE7QUFFM0I7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0lDLGFBQWFBLENBQUNDLFVBQVUsRUFBRTtBQUN0QkMsSUFBQUEsS0FBSyxDQUFDQyxNQUFNLENBQUNGLFVBQVUsQ0FBQyxDQUFBO0lBQ3hCQSxVQUFVLENBQUNHLFdBQVcsRUFBRSxDQUFBO0FBRXhCLElBQUEsTUFBTUMsWUFBWSxHQUFHSixVQUFVLENBQUNJLFlBQVksQ0FBQTtBQUM1QyxJQUFBLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHRCxZQUFZLENBQUNFLE1BQU0sRUFBRUQsQ0FBQyxFQUFFLEVBQUU7QUFDMUMsTUFBQSxNQUFNRSxJQUFJLEdBQUdILFlBQVksQ0FBQ0MsQ0FBQyxDQUFDLENBQUE7TUFDNUIsSUFBSUUsSUFBSSxDQUFDQyxPQUFPLEVBQUU7QUFDZCxRQUFBLElBQUksQ0FBQ1QsYUFBYSxDQUFDUSxJQUFJLENBQUMsQ0FBQTtBQUM1QixPQUFBO0FBQ0osS0FBQTtJQUVBLElBQUlQLFVBQVUsQ0FBQ1EsT0FBTyxFQUFFO0FBQ3BCLE1BQUEs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
