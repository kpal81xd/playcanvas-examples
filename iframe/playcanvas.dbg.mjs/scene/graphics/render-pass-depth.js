import { Color } from '../../core/math/color.js';
import { PIXELFORMAT_RGBA8, FILTER_NEAREST, ADDRESS_CLAMP_TO_EDGE } from '../../platform/graphics/constants.js';
import { Texture } from '../../platform/graphics/texture.js';
import { RenderPass } from '../../platform/graphics/render-pass.js';
import { BlendState } from '../../platform/graphics/blend-state.js';
import { RenderTarget } from '../../platform/graphics/render-target.js';
import { LAYERID_DEPTH, SHADER_DEPTH } from '../constants.js';

const webgl1DepthClearColor = new Color(254.0 / 255, 254.0 / 255, 254.0 / 255, 254.0 / 255);
const tempMeshInstances = [];
const lights = [[], [], []];

// uniform names (first is current name, second one is deprecated name for compatibility)
const _depthUniformNames = ['uSceneDepthMap', 'uDepthMap'];

/**
 * A render pass implementing rendering of depth. In current implementation, the depth is encoded in
 * RGBA8 texture, and is used on WebGL1 devices as a fallback for missing depth grab functionality.
 *
 * @ignore
 */
class RenderPassDepth extends RenderPass {
  constructor(device, renderer, camera) {
    super(device);
    this.renderer = renderer;
    this.camera = camera;
    this.setupRenderTarget();
  }
  destroy() {
    super.destroy();
    this.releaseRenderTarget(this.renderTarget);
  }
  update(scene) {
    this.scene = scene;
  }
  setupRenderTarget() {
    const texture = new Texture(this.device, {
      name: _depthUniformNames[0],
      format: PIXELFORMAT_RGBA8,
      width: 4,
      height: 4,
      mipmaps: false,
      minFilter: FILTER_NEAREST,
      magFilter: FILTER_NEAREST,
      addressU: ADDRESS_CLAMP_TO_EDGE,
      addressV: ADDRESS_CLAMP_TO_EDGE
    });
    const renderTarget = new RenderTarget({
      name: `${_depthUniformNames[0]}RT}`,
      colorBuffer: texture,
      depth: true,
      stencil: false
    });
    this.init(renderTarget, {});

    // webgl1 depth rendering clear values
    this.setClearColor(webgl1DepthClearColor);
    this.setClearDepth(1.0);
  }
  before() {
    // assign uniform
    const device = this.device;
    const colorBuffer = this.renderTarget.colorBuffer;
    _depthUniformNames.forEach(name => device.scope.resolve(name).setValue(colorBuffer));
  }
  execute() {
    const {
      device,
      renderer,
      camera,
      scene,
      renderTarget
    } = this;
    const layers = scene.layers.layerList;
    const subLayerEnabled = scene.layers.subLayerEnabled;
    const isTransparent = scene.layers.subLayerList;
    for (let i = 0; i < layers.length; i++) {
      const layer = layers[i];
      if (layer.enabled && subLayerEnabled[i]) {
        // if the layer is rendered by the camera
        if (layer.camerasSet.has(camera)) {
          // only render the layers before the depth layer
          if (layer.id === LAYERID_DEPTH) break;
          const culledInstances = layer.getCulledInstances(camera);
          const meshInstances = isTransparent[i] ? culledInstances.transparent : culledInstances.opaque;
          for (let j = 0; j < meshInstances.length; j++) {
            var _meshInstance$materia;
            const meshInstance = meshInstances[j];

            // only collect meshes that update the depth
            if ((_meshInstance$materia = meshInstance.material) != null && _meshInstance$materia.depthWrite) {
              tempMeshInstances.push(meshInstance);
            }
          }
          renderer.setCameraUniforms(camera, renderTarget);
          renderer.renderForward(camera, tempMeshInstances, lights, SHADER_DEPTH, meshInstance => {
            // writing depth to color render target, force no blending and writing to all channels
            device.setBlendState(BlendState.NOBLEND);
          }, layer);
          tempMeshInstances.length = 0;
        }
      }
    }
  }
}

export { RenderPassDepth };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyLXBhc3MtZGVwdGguanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9zY2VuZS9ncmFwaGljcy9yZW5kZXItcGFzcy1kZXB0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb2xvciB9IGZyb20gXCIuLi8uLi9jb3JlL21hdGgvY29sb3IuanNcIjtcbmltcG9ydCB7IEFERFJFU1NfQ0xBTVBfVE9fRURHRSwgRklMVEVSX05FQVJFU1QsIFBJWEVMRk9STUFUX1JHQkE4IH0gZnJvbSBcIi4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gXCIuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy90ZXh0dXJlLmpzXCI7XG5pbXBvcnQgeyBSZW5kZXJQYXNzIH0gZnJvbSBcIi4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL3JlbmRlci1wYXNzLmpzXCI7XG5pbXBvcnQgeyBCbGVuZFN0YXRlIH0gZnJvbSBcIi4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL2JsZW5kLXN0YXRlLmpzXCI7XG5pbXBvcnQgeyBSZW5kZXJUYXJnZXQgfSBmcm9tIFwiLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvcmVuZGVyLXRhcmdldC5qc1wiO1xuaW1wb3J0IHsgTEFZRVJJRF9ERVBUSCwgU0hBREVSX0RFUFRIIH0gZnJvbSBcIi4uL2NvbnN0YW50cy5qc1wiO1xuXG5jb25zdCB3ZWJnbDFEZXB0aENsZWFyQ29sb3IgPSBuZXcgQ29sb3IoMjU0LjAgLyAyNTUsIDI1NC4wIC8gMjU1LCAyNTQuMCAvIDI1NSwgMjU0LjAgLyAyNTUpO1xuY29uc3QgdGVtcE1lc2hJbnN0YW5jZXMgPSBbXTtcbmNvbnN0IGxpZ2h0cyA9IFtbXSwgW10sIFtdXTtcblxuLy8gdW5pZm9ybSBuYW1lcyAoZmlyc3QgaXMgY3VycmVudCBuYW1lLCBzZWNvbmQgb25lIGlzIGRlcHJlY2F0ZWQgbmFtZSBmb3IgY29tcGF0aWJpbGl0eSlcbmNvbnN0IF9kZXB0aFVuaWZvcm1OYW1lcyA9IFsndVNjZW5lRGVwdGhNYXAnLCAndURlcHRoTWFwJ107XG5cbi8qKlxuICogQSByZW5kZXIgcGFzcyBpbXBsZW1lbnRpbmcgcmVuZGVyaW5nIG9mIGRlcHRoLiBJbiBjdXJyZW50IGltcGxlbWVudGF0aW9uLCB0aGUgZGVwdGggaXMgZW5jb2RlZCBpblxuICogUkdCQTggdGV4dHVyZSwgYW5kIGlzIHVzZWQgb24gV2ViR0wxIGRldmljZXMgYXMgYSBmYWxsYmFjayBmb3IgbWlzc2luZyBkZXB0aCBncmFiIGZ1bmN0aW9uYWxpdHkuXG4gKlxuICogQGlnbm9yZVxuICovXG5jbGFzcyBSZW5kZXJQYXNzRGVwdGggZXh0ZW5kcyBSZW5kZXJQYXNzIHtcbiAgICBjb25zdHJ1Y3RvcihkZXZpY2UsIHJlbmRlcmVyLCBjYW1lcmEpIHtcbiAgICAgICAgc3VwZXIoZGV2aWNlKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLmNhbWVyYSA9IGNhbWVyYTtcblxuICAgICAgICB0aGlzLnNldHVwUmVuZGVyVGFyZ2V0KCk7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnJlbGVhc2VSZW5kZXJUYXJnZXQodGhpcy5yZW5kZXJUYXJnZXQpO1xuICAgIH1cblxuICAgIHVwZGF0ZShzY2VuZSkge1xuICAgICAgICB0aGlzLnNjZW5lID0gc2NlbmU7XG4gICAgfVxuXG4gICAgc2V0dXBSZW5kZXJUYXJnZXQoKSB7XG5cbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUZXh0dXJlKHRoaXMuZGV2aWNlLCB7XG4gICAgICAgICAgICBuYW1lOiBfZGVwdGhVbmlmb3JtTmFtZXNbMF0sXG4gICAgICAgICAgICBmb3JtYXQ6IFBJWEVMRk9STUFUX1JHQkE4LFxuICAgICAgICAgICAgd2lkdGg6IDQsXG4gICAgICAgICAgICBoZWlnaHQ6IDQsXG4gICAgICAgICAgICBtaXBtYXBzOiBmYWxzZSxcbiAgICAgICAgICAgIG1pbkZpbHRlcjogRklMVEVSX05FQVJFU1QsXG4gICAgICAgICAgICBtYWdGaWx0ZXI6IEZJTFRFUl9ORUFSRVNULFxuICAgICAgICAgICAgYWRkcmVzc1U6IEFERFJFU1NfQ0xBTVBfVE9fRURHRSxcbiAgICAgICAgICAgIGFkZHJlc3NWOiBBRERSRVNTX0NMQU1QX1RPX0VER0VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVuZGVyVGFyZ2V0ID0gbmV3IFJlbmRlclRhcmdldCh7XG4gICAgICAgICAgICBuYW1lOiBgJHtfZGVwdGhVbmlmb3JtTmFtZXNbMF19UlR9YCxcbiAgICAgICAgICAgIGNvbG9yQnVmZmVyOiB0ZXh0dXJlLFxuICAgICAgICAgICAgZGVwdGg6IHRydWUsXG4gICAgICAgICAgICBzdGVuY2lsOiBmYWxzZVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmluaXQocmVuZGVyVGFyZ2V0LCB7fSk7XG5cbiAgICAgICAgLy8gd2ViZ2wxIGRlcHRoIHJlbmRlcmluZyBjbGVhciB2YWx1ZXNcbiAgICAgICAgdGhpcy5zZXRDbGVhckNvbG9yKHdlYmdsMURlcHRoQ2xlYXJDb2xvcik7XG4gICAgICAgIHRoaXMuc2V0Q2xlYXJEZXB0aCgxLjApO1xuICAgIH1cblxuICAgIGJlZm9yZSgpIHtcblxuICAgICAgICAvLyBhc3NpZ24gdW5pZm9ybVxuICAgICAgICBjb25zdCBkZXZpY2UgPSB0aGlzLmRldmljZTtcbiAgICAgICAgY29uc3QgY29sb3JCdWZmZXIgPSB0aGlzLnJlbmRlclRhcmdldC5jb2xvckJ1ZmZlcjtcbiAgICAgICAgX2RlcHRoVW5pZm9ybU5hbWVzLmZvckVhY2gobmFtZSA9PiBkZXZpY2Uuc2NvcGUucmVzb2x2ZShuYW1lKS5zZXRWYWx1ZShjb2xvckJ1ZmZlcikpO1xuICAgIH1cblxuICAgIGV4ZWN1dGUoKSB7XG5cbiAgICAgICAgY29uc3QgeyBkZXZpY2UsIHJlbmRlcmVyLCBjYW1lcmEsIHNjZW5lLCByZW5kZXJUYXJnZXQgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGxheWVycyA9IHNjZW5lLmxheWVycy5sYXllckxpc3Q7XG4gICAgICAgIGNvbnN0IHN1YkxheWVyRW5hYmxlZCA9IHNjZW5lLmxheWVycy5zdWJMYXllckVuYWJsZWQ7XG4gICAgICAgIGNvbnN0IGlzVHJhbnNwYXJlbnQgPSBzY2VuZS5sYXllcnMuc3ViTGF5ZXJMaXN0O1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsYXllciA9IGxheWVyc1tpXTtcblxuICAgICAgICAgICAgaWYgKGxheWVyLmVuYWJsZWQgJiYgc3ViTGF5ZXJFbmFibGVkW2ldKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbGF5ZXIgaXMgcmVuZGVyZWQgYnkgdGhlIGNhbWVyYVxuICAgICAgICAgICAgICAgIGlmIChsYXllci5jYW1lcmFzU2V0LmhhcyhjYW1lcmEpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSByZW5kZXIgdGhlIGxheWVycyBiZWZvcmUgdGhlIGRlcHRoIGxheWVyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXllci5pZCA9PT0gTEFZRVJJRF9ERVBUSClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1bGxlZEluc3RhbmNlcyA9IGxheWVyLmdldEN1bGxlZEluc3RhbmNlcyhjYW1lcmEpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNoSW5zdGFuY2VzID0gaXNUcmFuc3BhcmVudFtpXSA/IGN1bGxlZEluc3RhbmNlcy50cmFuc3BhcmVudCA6IGN1bGxlZEluc3RhbmNlcy5vcGFxdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBtZXNoSW5zdGFuY2VzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNoSW5zdGFuY2UgPSBtZXNoSW5zdGFuY2VzW2pdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbmx5IGNvbGxlY3QgbWVzaGVzIHRoYXQgdXBkYXRlIHRoZSBkZXB0aFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lc2hJbnN0YW5jZS5tYXRlcmlhbD8uZGVwdGhXcml0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBNZXNoSW5zdGFuY2VzLnB1c2gobWVzaEluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcmVyLnNldENhbWVyYVVuaWZvcm1zKGNhbWVyYSwgcmVuZGVyVGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIucmVuZGVyRm9yd2FyZChjYW1lcmEsIHRlbXBNZXNoSW5zdGFuY2VzLCBsaWdodHMsIFNIQURFUl9ERVBUSCwgKG1lc2hJbnN0YW5jZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd3JpdGluZyBkZXB0aCB0byBjb2xvciByZW5kZXIgdGFyZ2V0LCBmb3JjZSBubyBibGVuZGluZyBhbmQgd3JpdGluZyB0byBhbGwgY2hhbm5lbHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZS5zZXRCbGVuZFN0YXRlKEJsZW5kU3RhdGUuTk9CTEVORCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGxheWVyKTtcblxuICAgICAgICAgICAgICAgICAgICB0ZW1wTWVzaEluc3RhbmNlcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgUmVuZGVyUGFzc0RlcHRoIH07XG4iXSwibmFtZXMiOlsid2ViZ2wxRGVwdGhDbGVhckNvbG9yIiwiQ29sb3IiLCJ0ZW1wTWVzaEluc3RhbmNlcyIsImxpZ2h0cyIsIl9kZXB0aFVuaWZvcm1OYW1lcyIsIlJlbmRlclBhc3NEZXB0aCIsIlJlbmRlclBhc3MiLCJjb25zdHJ1Y3RvciIsImRldmljZSIsInJlbmRlcmVyIiwiY2FtZXJhIiwic2V0dXBSZW5kZXJUYXJnZXQiLCJkZXN0cm95IiwicmVsZWFzZVJlbmRlclRhcmdldCIsInJlbmRlclRhcmdldCIsInVwZGF0ZSIsInNjZW5lIiwidGV4dHVyZSIsIlRleHR1cmUiLCJuYW1lIiwiZm9ybWF0IiwiUElYRUxGT1JNQVRfUkdCQTgiLCJ3aWR0aCIsImhlaWdodCIsIm1pcG1hcHMiLCJtaW5GaWx0ZXIiLCJGSUxURVJfTkVBUkVTVCIsIm1hZ0ZpbHRlciIsImFkZHJlc3NVIiwiQUREUkVTU19DTEFNUF9UT19FREdFIiwiYWRkcmVzc1YiLCJSZW5kZXJUYXJnZXQiLCJjb2xvckJ1ZmZlciIsImRlcHRoIiwic3RlbmNpbCIsImluaXQiLCJzZXRDbGVhckNvbG9yIiwic2V0Q2xlYXJEZXB0aCIsImJlZm9yZSIsImZvckVhY2giLCJzY29wZSIsInJlc29sdmUiLCJzZXRWYWx1ZSIsImV4ZWN1dGUiLCJsYXllcnMiLCJsYXllckxpc3QiLCJzdWJMYXllckVuYWJsZWQiLCJpc1RyYW5zcGFyZW50Iiwic3ViTGF5ZXJMaXN0IiwiaSIsImxlbmd0aCIsImxheWVyIiwiZW5hYmxlZCIsImNhbWVyYXNTZXQiLCJoYXMiLCJpZCIsIkxBWUVSSURfREVQVEgiLCJjdWxsZWRJbnN0YW5jZXMiLCJnZXRDdWxsZWRJbnN0YW5jZXMiLCJtZXNoSW5zdGFuY2VzIiwidHJhbnNwYXJlbnQiLCJvcGFxdWUiLCJqIiwiX21lc2hJbnN0YW5jZSRtYXRlcmlhIiwibWVzaEluc3RhbmNlIiwibWF0ZXJpYWwiLCJkZXB0aFdyaXRlIiwicHVzaCIsInNldENhbWVyYVVuaWZvcm1zIiwicmVuZGVyRm9yd2FyZCIsIlNIQURFUl9ERVBUSCIsInNldEJsZW5kU3RhdGUiLCJCbGVuZFN0YXRlIiwiTk9CTEVORCJdLCJt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
