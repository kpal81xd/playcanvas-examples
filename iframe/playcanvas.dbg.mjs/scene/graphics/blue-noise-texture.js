import { blueNoiseData } from '../../core/math/blue-noise.js';
import { PIXELFORMAT_RGBA8, ADDRESS_REPEAT, TEXTURETYPE_DEFAULT, FILTER_NEAREST } from '../../platform/graphics/constants.js';
import { DeviceCache } from '../../platform/graphics/device-cache.js';
import { Texture } from '../../platform/graphics/texture.js';

// device cache storing the blue noise texture for the device
const deviceCache = new DeviceCache();
function getBlueNoiseTexture(device) {
  return deviceCache.get(device, () => {
    const data = blueNoiseData();
    const size = Math.sqrt(data.length / 4);
    const texture = new Texture(device, {
      name: `BlueNoise${size}`,
      width: size,
      height: size,
      format: PIXELFORMAT_RGBA8,
      addressU: ADDRESS_REPEAT,
      addressV: ADDRESS_REPEAT,
      type: TEXTURETYPE_DEFAULT,
      magFilter: FILTER_NEAREST,
      minFilter: FILTER_NEAREST,
      anisotropy: 1,
      mipmaps: false
    });
    texture.lock().set(data);
    texture.unlock();
    return texture;
  });
}

export { getBlueNoiseTexture };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmx1ZS1ub2lzZS10ZXh0dXJlLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvc2NlbmUvZ3JhcGhpY3MvYmx1ZS1ub2lzZS10ZXh0dXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGJsdWVOb2lzZURhdGEgfSBmcm9tIFwiLi4vLi4vY29yZS9tYXRoL2JsdWUtbm9pc2UuanNcIjtcbmltcG9ydCB7IEFERFJFU1NfUkVQRUFULCBGSUxURVJfTkVBUkVTVCwgUElYRUxGT1JNQVRfUkdCQTgsIFRFWFRVUkVUWVBFX0RFRkFVTFQgfSBmcm9tIFwiLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgeyBEZXZpY2VDYWNoZSB9IGZyb20gXCIuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9kZXZpY2UtY2FjaGUuanNcIjtcbmltcG9ydCB7IFRleHR1cmUgfSBmcm9tIFwiLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvdGV4dHVyZS5qc1wiO1xuXG4vLyBkZXZpY2UgY2FjaGUgc3RvcmluZyB0aGUgYmx1ZSBub2lzZSB0ZXh0dXJlIGZvciB0aGUgZGV2aWNlXG5jb25zdCBkZXZpY2VDYWNoZSA9IG5ldyBEZXZpY2VDYWNoZSgpO1xuXG5mdW5jdGlvbiBnZXRCbHVlTm9pc2VUZXh0dXJlKGRldmljZSkge1xuXG4gICAgcmV0dXJuIGRldmljZUNhY2hlLmdldChkZXZpY2UsICgpID0+IHtcblxuICAgICAgICBjb25zdCBkYXRhID0gYmx1ZU5vaXNlRGF0YSgpO1xuICAgICAgICBjb25zdCBzaXplID0gTWF0aC5zcXJ0KGRhdGEubGVuZ3RoIC8gNCk7XG5cbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUZXh0dXJlKGRldmljZSwge1xuICAgICAgICAgICAgbmFtZTogYEJsdWVOb2lzZSR7c2l6ZX1gLFxuICAgICAgICAgICAgd2lkdGg6IHNpemUsXG4gICAgICAgICAgICBoZWlnaHQ6IHNpemUsXG4gICAgICAgICAgICBmb3JtYXQ6IFBJWEVMRk9STUFUX1JHQkE4LFxuICAgICAgICAgICAgYWRkcmVzc1U6IEFERFJFU1NfUkVQRUFULFxuICAgICAgICAgICAgYWRkcmVzc1Y6IEFERFJFU1NfUkVQRUFULFxuICAgICAgICAgICAgdHlwZTogVEVYVFVSRVRZUEVfREVGQVVMVCxcbiAgICAgICAgICAgIG1hZ0ZpbHRlcjogRklMVEVSX05FQVJFU1QsXG4gICAgICAgICAgICBtaW5GaWx0ZXI6IEZJTFRFUl9ORUFSRVNULFxuICAgICAgICAgICAgYW5pc290cm9weTogMSxcbiAgICAgICAgICAgIG1pcG1hcHM6IGZhbHNlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRleHR1cmUubG9jaygpLnNldChkYXRhKTtcbiAgICAgICAgdGV4dHVyZS51bmxvY2soKTtcblxuICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IHsgZ2V0Qmx1ZU5vaXNlVGV4dHVyZSB9O1xuIl0sIm5hbWVzIjpbImRldmljZUNhY2hlIiwiRGV2aWNlQ2FjaGUiLCJnZXRCbHVlTm9pc2VUZXh0dXJlIiwiZGV2aWNlIiwiZ2V0IiwiZGF0YSIsImJsdWVOb2lzZURhdGEiLCJzaXplIiwiTWF0aCIsInNxcnQiLCJsZW5ndGgiLCJ0ZXh0dXJlIiwiVGV4dHVyZSIsIm5hbWUiLCJ3aWR0aCIsImhlaWdodCIsImZvcm1hdCIsIlBJWEVMRk9STUFUX1JHQkE4IiwiYWRkcmVzc1UiLCJBRERSRVNTX1JFUEVBVCIsImFkZHJlc3NWIiwidHlwZSIsIlRFWFRVUkVUWVBFX0RFRkFVTFQiLCJtYWdGaWx0ZXIiLCJGSUxURVJfTkVBUkVTVCIsIm1pbkZpbHRlciIsImFuaXNvdHJvcHkiLCJtaXBtYXBzIiwibG9jayIsInNldCIsInVubG9jayJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFLQTtBQUNBLE1BQU1BLFdBQVcsR0FBRyxJQUFJQyxXQUFXLEVBQUUsQ0FBQTtBQUVyQyxTQUFTQyxtQkFBbUJBLENBQUNDLE1BQU0sRUFBRTtBQUVqQyxFQUFBLE9BQU9ILFdBQVcsQ0FBQ0ksR0FBRyxDQUFDRCxNQUFNLEVBQUUsTUFBTTtBQUVqQyxJQUFBLE1BQU1FLElBQUksR0FBR0MsYUFBYSxFQUFFLENBQUE7SUFDNUIsTUFBTUMsSUFBSSxHQUFHQyxJQUFJLENBQUNDLElBQUksQ0FBQ0osSUFBSSxDQUFDSyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUE7QUFFdkMsSUFBQSxNQUFNQyxPQUFPLEdBQUcsSUFBSUMsT0FBTyxDQUFDVCxNQUFNLEVBQUU7TUFDaENVLElBQUksRUFBRyxDQUFXTixTQUFBQSxFQUFBQSxJQUFLLENBQUMsQ0FBQTtBQUN4Qk8sTUFBQUEsS0FBSyxFQUFFUCxJQUFJO0FBQ1hRLE1BQUFBLE1BQU0sRUFBRVIsSUFBSTtBQUNaUyxNQUFBQSxNQUFNLEVBQUVDLGlCQUFpQjtBQUN6QkMsTUFBQUEsUUFBUSxFQUFFQyxjQUFjO0FBQ3hCQyxNQUFBQSxRQUFRLEVBQUVELGNBQWM7QUFDeEJFLE1BQUFBLElBQUksRUFBRUMsbUJBQW1CO0FBQ3pCQyxNQUFBQSxTQUFTLEVBQUVDLGNBQWM7QUFDekJDLE1BQUFBLFNBQVMsRUFBRUQsY0FBYztBQUN6QkUsTUFBQUEsVUFBVSxFQUFFLENBQUM7QUFDYkMsTUFBQUEsT0FBTyxFQUFFLEtBQUE7QUFDYixLQUFDLENBQUMsQ0FBQTtJQUVGaEIsT0FBTyxDQUFDaUIsSUFBSSxFQUFFLENBQUNDLEdBQUcsQ0FBQ3hCLElBQUksQ0FBQyxDQUFBO0lBQ3hCTSxPQUFPLENBQUNtQixNQUFNLEVBQUUsQ0FBQTtBQUVoQixJQUFBLE9BQU9uQixPQUFPLENBQUE7QUFDbEIsR0FBQyxDQUFDLENBQUE7QUFDTjs7OzsifQ==
