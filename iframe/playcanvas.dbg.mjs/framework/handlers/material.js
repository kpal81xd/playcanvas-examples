import { http } from '../../platform/net/http.js';
import { PIXELFORMAT_RGBA8 } from '../../platform/graphics/constants.js';
import { Texture } from '../../platform/graphics/texture.js';
import { SPECULAR_PHONG } from '../../scene/constants.js';
import { standardMaterialTextureParameters, standardMaterialCubemapParameters } from '../../scene/materials/standard-material-parameters.js';
import { AssetReference } from '../asset/asset-reference.js';
import { JsonStandardMaterialParser } from '../parsers/material/json-standard-material.js';
import { ResourceHandler } from './handler.js';

const PLACEHOLDER_MAP = {
  aoMap: 'white',
  diffuseMap: 'gray',
  specularMap: 'gray',
  specularityFactorMap: 'white',
  metalnessMap: 'black',
  glossMap: 'gray',
  sheenMap: 'black',
  sheenGlossinessMap: 'gray',
  clearCoatMap: 'black',
  clearCoatGlossMap: 'gray',
  clearCoatNormalMap: 'normal',
  refractionMap: 'white',
  emissiveMap: 'gray',
  normalMap: 'normal',
  heightMap: 'gray',
  opacityMap: 'gray',
  sphereMap: 'gray',
  lightMap: 'white'
};

/**
 * Resource handler used for loading {@link Material} resources.
 *
 * @category Graphics
 */
class MaterialHandler extends ResourceHandler {
  /**
   * Create a new MaterialHandler instance.
   *
   * @param {import('../app-base.js').AppBase} app - The running {@link AppBase}.
   * @ignore
   */
  constructor(app) {
    super(app, 'material');
    this._assets = app.assets;
    this._device = app.graphicsDevice;
    this._placeholderTextures = null;
    this._parser = new JsonStandardMaterialParser();
  }
  load(url, callback) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }

    // Loading from URL (engine-only)
    http.get(url.load, {
      retry: this.maxRetries > 0,
      maxRetries: this.maxRetries
    }, function (err, response) {
      if (!err) {
        if (callback) {
          response._engine = true;
          callback(null, response);
        }
      } else {
        if (callback) {
          callback(`Error loading material: ${url.original} [${err}]`);
        }
      }
    });
  }
  open(url, data) {
    const material = this._parser.parse(data);

    // temp storage for engine-only as we need this during patching
    if (data._engine) {
      material._data = data;
      delete data._engine;
    }
    return material;
  }

  // creates placeholders for textures
  // that are used while texture is loading
  _createPlaceholders() {
    this._placeholderTextures = {};
    const textures = {
      white: [255, 255, 255, 255],
      gray: [128, 128, 128, 255],
      black: [0, 0, 0, 255],
      normal: [128, 128, 255, 255]
    };
    for (const key in textures) {
      if (!textures.hasOwnProperty(key)) continue;

      // create texture
      this._placeholderTextures[key] = new Texture(this._device, {
        width: 2,
        height: 2,
        format: PIXELFORMAT_RGBA8,
        name: 'material_placeholder'
      });

      // fill pixels with color
      const pixels = this._placeholderTextures[key].lock();
      for (let i = 0; i < 4; i++) {
        for (let c = 0; c < 4; c++) {
          pixels[i * 4 + c] = textures[key][c];
        }
      }
      this._placeholderTextures[key].unlock();
    }
  }
  patch(asset, assets) {
    // in an engine-only environment we manually copy the source data into the asset
    if (asset.resource._data) {
      asset._data = asset.resource._data; // use _data to avoid firing events
      delete asset.resource._data; // remove from temp storage
    }

    // patch the name of the asset over the material name property
    asset.data.name = asset.name;
    asset.resource.name = asset.name;
    this._bindAndAssignAssets(asset, assets);
    asset.off('unload', this._onAssetUnload, this);
    asset.on('unload', this._onAssetUnload, this);
  }
  _onAssetUnload(asset) {
    // remove the parameter block we created which includes texture references
    delete asset.data.parameters;
    delete asset.data.chunks;
    delete asset.data.name;
  }
  _assignTexture(parameterName, materialAsset, texture) {
    // NB removed swapping out asset id for resource here
    materialAsset.resource[parameterName] = texture;
  }

  // returns the correct placeholder texture for the texture parameter
  _getPlaceholderTexture(parameterName) {
    // create placeholder textures on-demand
    if (!this._placeholderTextures) {
      this._createPlaceholders();
    }
    const placeholder = PLACEHOLDER_MAP[parameterName];
    const texture = this._placeholderTextures[placeholder];
    return texture;
  }

  // assign a placeholder texture while waiting for one to load
  _assignPlaceholderTexture(parameterName, materialAsset) {
    materialAsset.resource[parameterName] = this._getPlaceholderTexture(parameterName);
  }
  _onTextureLoad(parameterName, materialAsset, textureAsset) {
    this._assignTexture(parameterName, materialAsset, textureAsset.resource);
    materialAsset.resource.update();
  }
  _onTextureAdd(parameterName, materialAsset, textureAsset) {
    this._assets.load(textureAsset);
  }
  _onTextureRemoveOrUnload(parameterName, materialAsset, textureAsset) {
    const material = materialAsset.resource;
    if (material) {
      if (materialAsset.resource[parameterName] === textureAsset.resource) {
        this._assignPlaceholderTexture(parameterName, materialAsset);
        material.update();
      }
    }
  }
  _assignCubemap(parameterName, materialAsset, textures) {
    // the primary cubemap texture
    materialAsset.resource[parameterName] = textures[0];

    // set prefiltered textures
    if (parameterName === 'cubeMap') {
      const prefiltered = textures.slice(1);
      if (prefiltered.every(t => t)) {
        materialAsset.resource.prefilteredCubemaps = prefiltered;
      } else if (prefiltered[0]) {
        materialAsset.resource.envAtlas = prefiltered[0];
      }
    }
  }
  _onCubemapLoad(parameterName, materialAsset, cubemapAsset) {
    this._assignCubemap(parameterName, materialAsset, cubemapAsset.resources);
    this._parser.initialize(materialAsset.resource, materialAsset.data);
  }
  _onCubemapAdd(parameterName, materialAsset, cubemapAsset) {
    // phong based - so ensure we load individual faces
    if (materialAsset.data.shadingModel === SPECULAR_PHONG) {
      materialAsset.loadFaces = true;
    }
    this._assets.load(cubemapAsset);
  }
  _onCubemapRemoveOrUnload(parameterName, materialAsset, cubemapAsset) {
    const material = materialAsset.resource;
    if (materialAsset.data.prefilteredCubeMap128 === cubemapAsset.resources[1]) {
      this._assignCubemap(parameterName, materialAsset, [null, null, null, null, null, null, null]);
      material.update();
    }
  }
  _bindAndAssignAssets(materialAsset, assets) {
    // always migrate before updating material from asset data
    const data = this._parser.migrate(materialAsset.data);
    const material = materialAsset.resource;
    const pathMapping = data.mappingFormat === 'path';
    const TEXTURES = standardMaterialTextureParameters;
    let i, name, assetReference;
    // iterate through all texture parameters
    for (i = 0; i < TEXTURES.length; i++) {
      name = TEXTURES[i];
      assetReference = material._assetReferences[name];

      // data[name] contains an asset id for a texture
      // if we have an asset id and nothing is assigned to the texture resource or the placeholder texture is assigned
      // or the data has changed
      const dataAssetId = data[name];
      const materialTexture = material[name];
      const isPlaceHolderTexture = materialTexture === this._getPlaceholderTexture(name);
      const dataValidated = data.validated;
      if (dataAssetId && (!materialTexture || !dataValidated || isPlaceHolderTexture)) {
        if (!assetReference) {
          assetReference = new AssetReference(name, materialAsset, assets, {
            load: this._onTextureLoad,
            add: this._onTextureAdd,
            remove: this._onTextureRemoveOrUnload,
            unload: this._onTextureRemoveOrUnload
          }, this);
          material._assetReferences[name] = assetReference;
        }
        if (pathMapping) {
          // texture paths are measured from the material directory
          assetReference.url = materialAsset.getAbsoluteUrl(dataAssetId);
        } else {
          assetReference.id = dataAssetId;
        }
        if (assetReference.asset) {
          if (assetReference.asset.resource) {
            // asset is already loaded
            this._assignTexture(name, materialAsset, assetReference.asset.resource);
          } else {
            this._assignPlaceholderTexture(name, materialAsset);
          }
          assets.load(assetReference.asset);
        }
      } else {
        if (assetReference) {
          // texture has been removed
          if (pathMapping) {
            assetReference.url = null;
          } else {
            assetReference.id = null;
          }
        }
      }
    }
    const CUBEMAPS = standardMaterialCubemapParameters;

    // iterate through all cubemap parameters
    for (i = 0; i < CUBEMAPS.length; i++) {
      name = CUBEMAPS[i];
      assetReference = material._assetReferences[name];

      // data[name] contains an asset id for a cubemap
      // if we have a asset id and the prefiltered cubemap data is not set
      if (data[name] && !materialAsset.data.prefilteredCubeMap128) {
        if (!assetReference) {
          assetReference = new AssetReference(name, materialAsset, assets, {
            load: this._onCubemapLoad,
            add: this._onCubemapAdd,
            remove: this._onCubemapRemoveOrUnload,
            unload: this._onCubemapRemoveOrUnload
          }, this);
          material._assetReferences[name] = assetReference;
        }
        if (pathMapping) {
          assetReference.url = data[name];
        } else {
          assetReference.id = data[name];
        }
        if (assetReference.asset) {
          if (assetReference.asset.loaded) {
            // asset loaded
            this._assignCubemap(name, materialAsset, assetReference.asset.resources);
          }
          assets.load(assetReference.asset);
        }
      }
    }

    // call to re-initialize material after all textures assigned
    this._parser.initialize(material, data);
  }
}

export { MaterialHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0ZXJpYWwuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvaGFuZGxlcnMvbWF0ZXJpYWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaHR0cCB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL25ldC9odHRwLmpzJztcblxuaW1wb3J0IHsgUElYRUxGT1JNQVRfUkdCQTggfSBmcm9tICcuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL3RleHR1cmUuanMnO1xuXG5pbXBvcnQgeyBTUEVDVUxBUl9QSE9ORyB9IGZyb20gJy4uLy4uL3NjZW5lL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgeyBzdGFuZGFyZE1hdGVyaWFsQ3ViZW1hcFBhcmFtZXRlcnMsIHN0YW5kYXJkTWF0ZXJpYWxUZXh0dXJlUGFyYW1ldGVycyB9IGZyb20gJy4uLy4uL3NjZW5lL21hdGVyaWFscy9zdGFuZGFyZC1tYXRlcmlhbC1wYXJhbWV0ZXJzLmpzJztcblxuaW1wb3J0IHsgQXNzZXRSZWZlcmVuY2UgfSBmcm9tICcuLi9hc3NldC9hc3NldC1yZWZlcmVuY2UuanMnO1xuaW1wb3J0IHsgSnNvblN0YW5kYXJkTWF0ZXJpYWxQYXJzZXIgfSBmcm9tICcuLi9wYXJzZXJzL21hdGVyaWFsL2pzb24tc3RhbmRhcmQtbWF0ZXJpYWwuanMnO1xuXG5pbXBvcnQgeyBSZXNvdXJjZUhhbmRsZXIgfSBmcm9tICcuL2hhbmRsZXIuanMnO1xuXG5jb25zdCBQTEFDRUhPTERFUl9NQVAgPSB7XG4gICAgYW9NYXA6ICd3aGl0ZScsXG4gICAgZGlmZnVzZU1hcDogJ2dyYXknLFxuICAgIHNwZWN1bGFyTWFwOiAnZ3JheScsXG4gICAgc3BlY3VsYXJpdHlGYWN0b3JNYXA6ICd3aGl0ZScsXG4gICAgbWV0YWxuZXNzTWFwOiAnYmxhY2snLFxuICAgIGdsb3NzTWFwOiAnZ3JheScsXG4gICAgc2hlZW5NYXA6ICdibGFjaycsXG4gICAgc2hlZW5HbG9zc2luZXNzTWFwOiAnZ3JheScsXG4gICAgY2xlYXJDb2F0TWFwOiAnYmxhY2snLFxuICAgIGNsZWFyQ29hdEdsb3NzTWFwOiAnZ3JheScsXG4gICAgY2xlYXJDb2F0Tm9ybWFsTWFwOiAnbm9ybWFsJyxcbiAgICByZWZyYWN0aW9uTWFwOiAnd2hpdGUnLFxuICAgIGVtaXNzaXZlTWFwOiAnZ3JheScsXG4gICAgbm9ybWFsTWFwOiAnbm9ybWFsJyxcbiAgICBoZWlnaHRNYXA6ICdncmF5JyxcbiAgICBvcGFjaXR5TWFwOiAnZ3JheScsXG4gICAgc3BoZXJlTWFwOiAnZ3JheScsXG4gICAgbGlnaHRNYXA6ICd3aGl0ZSdcbn07XG5cbi8qKlxuICogUmVzb3VyY2UgaGFuZGxlciB1c2VkIGZvciBsb2FkaW5nIHtAbGluayBNYXRlcmlhbH0gcmVzb3VyY2VzLlxuICpcbiAqIEBjYXRlZ29yeSBHcmFwaGljc1xuICovXG5jbGFzcyBNYXRlcmlhbEhhbmRsZXIgZXh0ZW5kcyBSZXNvdXJjZUhhbmRsZXIge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBNYXRlcmlhbEhhbmRsZXIgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBhcHAgLSBUaGUgcnVubmluZyB7QGxpbmsgQXBwQmFzZX0uXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICBzdXBlcihhcHAsICdtYXRlcmlhbCcpO1xuXG4gICAgICAgIHRoaXMuX2Fzc2V0cyA9IGFwcC5hc3NldHM7XG4gICAgICAgIHRoaXMuX2RldmljZSA9IGFwcC5ncmFwaGljc0RldmljZTtcblxuICAgICAgICB0aGlzLl9wbGFjZWhvbGRlclRleHR1cmVzID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9wYXJzZXIgPSBuZXcgSnNvblN0YW5kYXJkTWF0ZXJpYWxQYXJzZXIoKTtcbiAgICB9XG5cbiAgICBsb2FkKHVybCwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB1cmwgPSB7XG4gICAgICAgICAgICAgICAgbG9hZDogdXJsLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsOiB1cmxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMb2FkaW5nIGZyb20gVVJMIChlbmdpbmUtb25seSlcbiAgICAgICAgaHR0cC5nZXQodXJsLmxvYWQsIHtcbiAgICAgICAgICAgIHJldHJ5OiB0aGlzLm1heFJldHJpZXMgPiAwLFxuICAgICAgICAgICAgbWF4UmV0cmllczogdGhpcy5tYXhSZXRyaWVzXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnIsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5fZW5naW5lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGBFcnJvciBsb2FkaW5nIG1hdGVyaWFsOiAke3VybC5vcmlnaW5hbH0gWyR7ZXJyfV1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9wZW4odXJsLCBkYXRhKSB7XG4gICAgICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5fcGFyc2VyLnBhcnNlKGRhdGEpO1xuXG4gICAgICAgIC8vIHRlbXAgc3RvcmFnZSBmb3IgZW5naW5lLW9ubHkgYXMgd2UgbmVlZCB0aGlzIGR1cmluZyBwYXRjaGluZ1xuICAgICAgICBpZiAoZGF0YS5fZW5naW5lKSB7XG4gICAgICAgICAgICBtYXRlcmlhbC5fZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICBkZWxldGUgZGF0YS5fZW5naW5lO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1hdGVyaWFsO1xuICAgIH1cblxuICAgIC8vIGNyZWF0ZXMgcGxhY2Vob2xkZXJzIGZvciB0ZXh0dXJlc1xuICAgIC8vIHRoYXQgYXJlIHVzZWQgd2hpbGUgdGV4dHVyZSBpcyBsb2FkaW5nXG4gICAgX2NyZWF0ZVBsYWNlaG9sZGVycygpIHtcbiAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXJUZXh0dXJlcyA9IHt9O1xuXG4gICAgICAgIGNvbnN0IHRleHR1cmVzID0ge1xuICAgICAgICAgICAgd2hpdGU6IFsyNTUsIDI1NSwgMjU1LCAyNTVdLFxuICAgICAgICAgICAgZ3JheTogWzEyOCwgMTI4LCAxMjgsIDI1NV0sXG4gICAgICAgICAgICBibGFjazogWzAsIDAsIDAsIDI1NV0sXG4gICAgICAgICAgICBub3JtYWw6IFsxMjgsIDEyOCwgMjU1LCAyNTVdXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGV4dHVyZXMpIHtcbiAgICAgICAgICAgIGlmICghdGV4dHVyZXMuaGFzT3duUHJvcGVydHkoa2V5KSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIHRleHR1cmVcbiAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyVGV4dHVyZXNba2V5XSA9IG5ldyBUZXh0dXJlKHRoaXMuX2RldmljZSwge1xuICAgICAgICAgICAgICAgIHdpZHRoOiAyLFxuICAgICAgICAgICAgICAgIGhlaWdodDogMixcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IFBJWEVMRk9STUFUX1JHQkE4LFxuICAgICAgICAgICAgICAgIG5hbWU6ICdtYXRlcmlhbF9wbGFjZWhvbGRlcidcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBmaWxsIHBpeGVscyB3aXRoIGNvbG9yXG4gICAgICAgICAgICBjb25zdCBwaXhlbHMgPSB0aGlzLl9wbGFjZWhvbGRlclRleHR1cmVzW2tleV0ubG9jaygpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IDQ7IGMrKykge1xuICAgICAgICAgICAgICAgICAgICBwaXhlbHNbaSAqIDQgKyBjXSA9IHRleHR1cmVzW2tleV1bY107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXJUZXh0dXJlc1trZXldLnVubG9jaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcGF0Y2goYXNzZXQsIGFzc2V0cykge1xuICAgICAgICAvLyBpbiBhbiBlbmdpbmUtb25seSBlbnZpcm9ubWVudCB3ZSBtYW51YWxseSBjb3B5IHRoZSBzb3VyY2UgZGF0YSBpbnRvIHRoZSBhc3NldFxuICAgICAgICBpZiAoYXNzZXQucmVzb3VyY2UuX2RhdGEpIHtcbiAgICAgICAgICAgIGFzc2V0Ll9kYXRhID0gYXNzZXQucmVzb3VyY2UuX2RhdGE7IC8vIHVzZSBfZGF0YSB0byBhdm9pZCBmaXJpbmcgZXZlbnRzXG4gICAgICAgICAgICBkZWxldGUgYXNzZXQucmVzb3VyY2UuX2RhdGE7IC8vIHJlbW92ZSBmcm9tIHRlbXAgc3RvcmFnZVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGF0Y2ggdGhlIG5hbWUgb2YgdGhlIGFzc2V0IG92ZXIgdGhlIG1hdGVyaWFsIG5hbWUgcHJvcGVydHlcbiAgICAgICAgYXNzZXQuZGF0YS5uYW1lID0gYXNzZXQubmFtZTtcbiAgICAgICAgYXNzZXQucmVzb3VyY2UubmFtZSA9IGFzc2V0Lm5hbWU7XG5cbiAgICAgICAgdGhpcy5fYmluZEFuZEFzc2lnbkFzc2V0cyhhc3NldCwgYXNzZXRzKTtcblxuICAgICAgICBhc3NldC5vZmYoJ3VubG9hZCcsIHRoaXMuX29uQXNzZXRVbmxvYWQsIHRoaXMpO1xuICAgICAgICBhc3NldC5vbigndW5sb2FkJywgdGhpcy5fb25Bc3NldFVubG9hZCwgdGhpcyk7XG4gICAgfVxuXG4gICAgX29uQXNzZXRVbmxvYWQoYXNzZXQpIHtcbiAgICAgICAgLy8gcmVtb3ZlIHRoZSBwYXJhbWV0ZXIgYmxvY2sgd2UgY3JlYXRlZCB3aGljaCBpbmNsdWRlcyB0ZXh0dXJlIHJlZmVyZW5jZXNcbiAgICAgICAgZGVsZXRlIGFzc2V0LmRhdGEucGFyYW1ldGVycztcbiAgICAgICAgZGVsZXRlIGFzc2V0LmRhdGEuY2h1bmtzO1xuICAgICAgICBkZWxldGUgYXNzZXQuZGF0YS5uYW1lO1xuICAgIH1cblxuICAgIF9hc3NpZ25UZXh0dXJlKHBhcmFtZXRlck5hbWUsIG1hdGVyaWFsQXNzZXQsIHRleHR1cmUpIHtcbiAgICAgICAgLy8gTkIgcmVtb3ZlZCBzd2FwcGluZyBvdXQgYXNzZXQgaWQgZm9yIHJlc291cmNlIGhlcmVcbiAgICAgICAgbWF0ZXJpYWxBc3NldC5yZXNvdXJjZVtwYXJhbWV0ZXJOYW1lXSA9IHRleHR1cmU7XG4gICAgfVxuXG4gICAgLy8gcmV0dXJucyB0aGUgY29ycmVjdCBwbGFjZWhvbGRlciB0ZXh0dXJlIGZvciB0aGUgdGV4dHVyZSBwYXJhbWV0ZXJcbiAgICBfZ2V0UGxhY2Vob2xkZXJUZXh0dXJlKHBhcmFtZXRlck5hbWUpIHtcbiAgICAgICAgLy8gY3JlYXRlIHBsYWNlaG9sZGVyIHRleHR1cmVzIG9uLWRlbWFuZFxuICAgICAgICBpZiAoIXRoaXMuX3BsYWNlaG9sZGVyVGV4dHVyZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVBsYWNlaG9sZGVycygpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBQTEFDRUhPTERFUl9NQVBbcGFyYW1ldGVyTmFtZV07XG4gICAgICAgIGNvbnN0IHRleHR1cmUgPSB0aGlzLl9wbGFjZWhvbGRlclRleHR1cmVzW3BsYWNlaG9sZGVyXTtcblxuICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICB9XG5cbiAgICAvLyBhc3NpZ24gYSBwbGFjZWhvbGRlciB0ZXh0dXJlIHdoaWxlIHdhaXRpbmcgZm9yIG9uZSB0byBsb2FkXG4gICAgX2Fzc2lnblBsYWNlaG9sZGVyVGV4dHVyZShwYXJhbWV0ZXJOYW1lLCBtYXRlcmlhbEFzc2V0KSB7XG5cbiAgICAgICAgbWF0ZXJpYWxBc3NldC5yZXNvdXJjZVtwYXJhbWV0ZXJOYW1lXSA9IHRoaXMuX2dldFBsYWNlaG9sZGVyVGV4dHVyZShwYXJhbWV0ZXJOYW1lKTtcbiAgICB9XG5cbiAgICBfb25UZXh0dXJlTG9hZChwYXJhbWV0ZXJOYW1lLCBtYXRlcmlhbEFzc2V0LCB0ZXh0dXJlQXNzZXQpIHtcbiAgICAgICAgdGhpcy5fYXNzaWduVGV4dHVyZShwYXJhbWV0ZXJOYW1lLCBtYXRlcmlhbEFzc2V0LCB0ZXh0dXJlQXNzZXQucmVzb3VyY2UpO1xuICAgICAgICBtYXRlcmlhbEFzc2V0LnJlc291cmNlLnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIF9vblRleHR1cmVBZGQocGFyYW1ldGVyTmFtZSwgbWF0ZXJpYWxBc3NldCwgdGV4dHVyZUFzc2V0KSB7XG4gICAgICAgIHRoaXMuX2Fzc2V0cy5sb2FkKHRleHR1cmVBc3NldCk7XG4gICAgfVxuXG4gICAgX29uVGV4dHVyZVJlbW92ZU9yVW5sb2FkKHBhcmFtZXRlck5hbWUsIG1hdGVyaWFsQXNzZXQsIHRleHR1cmVBc3NldCkge1xuICAgICAgICBjb25zdCBtYXRlcmlhbCA9IG1hdGVyaWFsQXNzZXQucmVzb3VyY2U7XG4gICAgICAgIGlmIChtYXRlcmlhbCkge1xuICAgICAgICAgICAgaWYgKG1hdGVyaWFsQXNzZXQucmVzb3VyY2VbcGFyYW1ldGVyTmFtZV0gPT09IHRleHR1cmVBc3NldC5yZXNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2lnblBsYWNlaG9sZGVyVGV4dHVyZShwYXJhbWV0ZXJOYW1lLCBtYXRlcmlhbEFzc2V0KTtcbiAgICAgICAgICAgICAgICBtYXRlcmlhbC51cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9hc3NpZ25DdWJlbWFwKHBhcmFtZXRlck5hbWUsIG1hdGVyaWFsQXNzZXQsIHRleHR1cmVzKSB7XG4gICAgICAgIC8vIHRoZSBwcmltYXJ5IGN1YmVtYXAgdGV4dHVyZVxuICAgICAgICBtYXRlcmlhbEFzc2V0LnJlc291cmNlW3BhcmFtZXRlck5hbWVdID0gdGV4dHVyZXNbMF07XG5cbiAgICAgICAgLy8gc2V0IHByZWZpbHRlcmVkIHRleHR1cmVzXG4gICAgICAgIGlmIChwYXJhbWV0ZXJOYW1lID09PSAnY3ViZU1hcCcpIHtcbiAgICAgICAgICAgIGNvbnN0IHByZWZpbHRlcmVkID0gdGV4dHVyZXMuc2xpY2UoMSk7XG4gICAgICAgICAgICBpZiAocHJlZmlsdGVyZWQuZXZlcnkodCA9PiB0KSkge1xuICAgICAgICAgICAgICAgIG1hdGVyaWFsQXNzZXQucmVzb3VyY2UucHJlZmlsdGVyZWRDdWJlbWFwcyA9IHByZWZpbHRlcmVkO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwcmVmaWx0ZXJlZFswXSkge1xuICAgICAgICAgICAgICAgIG1hdGVyaWFsQXNzZXQucmVzb3VyY2UuZW52QXRsYXMgPSBwcmVmaWx0ZXJlZFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vbkN1YmVtYXBMb2FkKHBhcmFtZXRlck5hbWUsIG1hdGVyaWFsQXNzZXQsIGN1YmVtYXBBc3NldCkge1xuICAgICAgICB0aGlzLl9hc3NpZ25DdWJlbWFwKHBhcmFtZXRlck5hbWUsIG1hdGVyaWFsQXNzZXQsIGN1YmVtYXBBc3NldC5yZXNvdXJjZXMpO1xuICAgICAgICB0aGlzLl9wYXJzZXIuaW5pdGlhbGl6ZShtYXRlcmlhbEFzc2V0LnJlc291cmNlLCBtYXRlcmlhbEFzc2V0LmRhdGEpO1xuICAgIH1cblxuICAgIF9vbkN1YmVtYXBBZGQocGFyYW1ldGVyTmFtZSwgbWF0ZXJpYWxBc3NldCwgY3ViZW1hcEFzc2V0KSB7XG4gICAgICAgIC8vIHBob25nIGJhc2VkIC0gc28gZW5zdXJlIHdlIGxvYWQgaW5kaXZpZHVhbCBmYWNlc1xuICAgICAgICBpZiAobWF0ZXJpYWxBc3NldC5kYXRhLnNoYWRpbmdNb2RlbCA9PT0gU1BFQ1VMQVJfUEhPTkcpIHtcbiAgICAgICAgICAgIG1hdGVyaWFsQXNzZXQubG9hZEZhY2VzID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2Fzc2V0cy5sb2FkKGN1YmVtYXBBc3NldCk7XG4gICAgfVxuXG4gICAgX29uQ3ViZW1hcFJlbW92ZU9yVW5sb2FkKHBhcmFtZXRlck5hbWUsIG1hdGVyaWFsQXNzZXQsIGN1YmVtYXBBc3NldCkge1xuICAgICAgICBjb25zdCBtYXRlcmlhbCA9IG1hdGVyaWFsQXNzZXQucmVzb3VyY2U7XG5cbiAgICAgICAgaWYgKG1hdGVyaWFsQXNzZXQuZGF0YS5wcmVmaWx0ZXJlZEN1YmVNYXAxMjggPT09IGN1YmVtYXBBc3NldC5yZXNvdXJjZXNbMV0pIHtcbiAgICAgICAgICAgIHRoaXMuX2Fzc2lnbkN1YmVtYXAocGFyYW1ldGVyTmFtZSwgbWF0ZXJpYWxBc3NldCwgW251bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGxdKTtcbiAgICAgICAgICAgIG1hdGVyaWFsLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2JpbmRBbmRBc3NpZ25Bc3NldHMobWF0ZXJpYWxBc3NldCwgYXNzZXRzKSB7XG4gICAgICAgIC8vIGFsd2F5cyBtaWdyYXRlIGJlZm9yZSB1cGRhdGluZyBtYXRlcmlhbCBmcm9tIGFzc2V0IGRhdGFcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX3BhcnNlci5taWdyYXRlKG1hdGVyaWFsQXNzZXQuZGF0YSk7XG5cbiAgICAgICAgY29uc3QgbWF0ZXJpYWwgPSBtYXRlcmlhbEFzc2V0LnJlc291cmNlO1xuXG4gICAgICAgIGNvbnN0IHBhdGhNYXBwaW5nID0gKGRhdGEubWFwcGluZ0Zvcm1hdCA9PT0gJ3BhdGgnKTtcblxuICAgICAgICBjb25zdCBURVhUVVJFUyA9IHN0YW5kYXJkTWF0ZXJpYWxUZXh0dXJlUGFyYW1ldGVycztcblxuICAgICAgICBsZXQgaSwgbmFtZSwgYXNzZXRSZWZlcmVuY2U7XG4gICAgICAgIC8vIGl0ZXJhdGUgdGhyb3VnaCBhbGwgdGV4dHVyZSBwYXJhbWV0ZXJzXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBURVhUVVJFUy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbmFtZSA9IFRFWFRVUkVTW2ldO1xuXG4gICAgICAgICAgICBhc3NldFJlZmVyZW5jZSA9IG1hdGVyaWFsLl9hc3NldFJlZmVyZW5jZXNbbmFtZV07XG5cbiAgICAgICAgICAgIC8vIGRhdGFbbmFtZV0gY29udGFpbnMgYW4gYXNzZXQgaWQgZm9yIGEgdGV4dHVyZVxuICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhbiBhc3NldCBpZCBhbmQgbm90aGluZyBpcyBhc3NpZ25lZCB0byB0aGUgdGV4dHVyZSByZXNvdXJjZSBvciB0aGUgcGxhY2Vob2xkZXIgdGV4dHVyZSBpcyBhc3NpZ25lZFxuICAgICAgICAgICAgLy8gb3IgdGhlIGRhdGEgaGFzIGNoYW5nZWRcbiAgICAgICAgICAgIGNvbnN0IGRhdGFBc3NldElkID0gZGF0YVtuYW1lXTtcblxuICAgICAgICAgICAgY29uc3QgbWF0ZXJpYWxUZXh0dXJlID0gbWF0ZXJpYWxbbmFtZV07XG4gICAgICAgICAgICBjb25zdCBpc1BsYWNlSG9sZGVyVGV4dHVyZSA9IG1hdGVyaWFsVGV4dHVyZSA9PT0gdGhpcy5fZ2V0UGxhY2Vob2xkZXJUZXh0dXJlKG5hbWUpO1xuICAgICAgICAgICAgY29uc3QgZGF0YVZhbGlkYXRlZCA9IGRhdGEudmFsaWRhdGVkO1xuXG4gICAgICAgICAgICBpZiAoZGF0YUFzc2V0SWQgJiYgKCFtYXRlcmlhbFRleHR1cmUgfHwgIWRhdGFWYWxpZGF0ZWQgfHwgaXNQbGFjZUhvbGRlclRleHR1cmUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhc3NldFJlZmVyZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBhc3NldFJlZmVyZW5jZSA9IG5ldyBBc3NldFJlZmVyZW5jZShuYW1lLCBtYXRlcmlhbEFzc2V0LCBhc3NldHMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWQ6IHRoaXMuX29uVGV4dHVyZUxvYWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGQ6IHRoaXMuX29uVGV4dHVyZUFkZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZTogdGhpcy5fb25UZXh0dXJlUmVtb3ZlT3JVbmxvYWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmxvYWQ6IHRoaXMuX29uVGV4dHVyZVJlbW92ZU9yVW5sb2FkXG4gICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsLl9hc3NldFJlZmVyZW5jZXNbbmFtZV0gPSBhc3NldFJlZmVyZW5jZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAocGF0aE1hcHBpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGV4dHVyZSBwYXRocyBhcmUgbWVhc3VyZWQgZnJvbSB0aGUgbWF0ZXJpYWwgZGlyZWN0b3J5XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0UmVmZXJlbmNlLnVybCA9IG1hdGVyaWFsQXNzZXQuZ2V0QWJzb2x1dGVVcmwoZGF0YUFzc2V0SWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0UmVmZXJlbmNlLmlkID0gZGF0YUFzc2V0SWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0UmVmZXJlbmNlLmFzc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3NldFJlZmVyZW5jZS5hc3NldC5yZXNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXNzZXQgaXMgYWxyZWFkeSBsb2FkZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2lnblRleHR1cmUobmFtZSwgbWF0ZXJpYWxBc3NldCwgYXNzZXRSZWZlcmVuY2UuYXNzZXQucmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXNzaWduUGxhY2Vob2xkZXJUZXh0dXJlKG5hbWUsIG1hdGVyaWFsQXNzZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYXNzZXRzLmxvYWQoYXNzZXRSZWZlcmVuY2UuYXNzZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0UmVmZXJlbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRleHR1cmUgaGFzIGJlZW4gcmVtb3ZlZFxuICAgICAgICAgICAgICAgICAgICBpZiAocGF0aE1hcHBpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0UmVmZXJlbmNlLnVybCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NldFJlZmVyZW5jZS5pZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBubyBhc3NldCByZWZlcmVuY2UgYW5kIG5vIGRhdGEgZmllbGRcbiAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IENVQkVNQVBTID0gc3RhbmRhcmRNYXRlcmlhbEN1YmVtYXBQYXJhbWV0ZXJzO1xuXG4gICAgICAgIC8vIGl0ZXJhdGUgdGhyb3VnaCBhbGwgY3ViZW1hcCBwYXJhbWV0ZXJzXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBDVUJFTUFQUy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbmFtZSA9IENVQkVNQVBTW2ldO1xuXG4gICAgICAgICAgICBhc3NldFJlZmVyZW5jZSA9IG1hdGVyaWFsLl9hc3NldFJlZmVyZW5jZXNbbmFtZV07XG5cbiAgICAgICAgICAgIC8vIGRhdGFbbmFtZV0gY29udGFpbnMgYW4gYXNzZXQgaWQgZm9yIGEgY3ViZW1hcFxuICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhIGFzc2V0IGlkIGFuZCB0aGUgcHJlZmlsdGVyZWQgY3ViZW1hcCBkYXRhIGlzIG5vdCBzZXRcbiAgICAgICAgICAgIGlmIChkYXRhW25hbWVdICYmICFtYXRlcmlhbEFzc2V0LmRhdGEucHJlZmlsdGVyZWRDdWJlTWFwMTI4KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhc3NldFJlZmVyZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBhc3NldFJlZmVyZW5jZSA9IG5ldyBBc3NldFJlZmVyZW5jZShuYW1lLCBtYXRlcmlhbEFzc2V0LCBhc3NldHMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWQ6IHRoaXMuX29uQ3ViZW1hcExvYWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGQ6IHRoaXMuX29uQ3ViZW1hcEFkZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZTogdGhpcy5fb25DdWJlbWFwUmVtb3ZlT3JVbmxvYWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bmxvYWQ6IHRoaXMuX29uQ3ViZW1hcFJlbW92ZU9yVW5sb2FkXG4gICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsLl9hc3NldFJlZmVyZW5jZXNbbmFtZV0gPSBhc3NldFJlZmVyZW5jZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAocGF0aE1hcHBpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRSZWZlcmVuY2UudXJsID0gZGF0YVtuYW1lXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhc3NldFJlZmVyZW5jZS5pZCA9IGRhdGFbbmFtZV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0UmVmZXJlbmNlLmFzc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3NldFJlZmVyZW5jZS5hc3NldC5sb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzc2V0IGxvYWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXNzaWduQ3ViZW1hcChuYW1lLCBtYXRlcmlhbEFzc2V0LCBhc3NldFJlZmVyZW5jZS5hc3NldC5yZXNvdXJjZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYXNzZXRzLmxvYWQoYXNzZXRSZWZlcmVuY2UuYXNzZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBjYWxsIHRvIHJlLWluaXRpYWxpemUgbWF0ZXJpYWwgYWZ0ZXIgYWxsIHRleHR1cmVzIGFzc2lnbmVkXG4gICAgICAgIHRoaXMuX3BhcnNlci5pbml0aWFsaXplKG1hdGVyaWFsLCBkYXRhKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IE1hdGVyaWFsSGFuZGxlciB9O1xuIl0sIm5hbWVzIjpbIlBMQUNFSE9MREVSX01BUCIsImFvTWFwIiwiZGlmZnVzZU1hcCIsInNwZWN1bGFyTWFwIiwic3BlY3VsYXJpdHlGYWN0b3JNYXAiLCJtZXRhbG5lc3NNYXAiLCJnbG9zc01hcCIsInNoZWVuTWFwIiwic2hlZW5HbG9zc2luZXNzTWFwIiwiY2xlYXJDb2F0TWFwIiwiY2xlYXJDb2F0R2xvc3NNYXAiLCJjbGVhckNvYXROb3JtYWxNYXAiLCJyZWZyYWN0aW9uTWFwIiwiZW1pc3NpdmVNYXAiLCJub3JtYWxNYXAiLCJoZWlnaHRNYXAiLCJvcGFjaXR5TWFwIiwic3BoZXJlTWFwIiwibGlnaHRNYXAiLCJNYXRlcmlhbEhhbmRsZXIiLCJSZXNvdXJjZUhhbmRsZXIiLCJjb25zdHJ1Y3RvciIsImFwcCIsIl9hc3NldHMiLCJhc3NldHMiLCJfZGV2aWNlIiwiZ3JhcGhpY3NEZXZpY2UiLCJfcGxhY2Vob2xkZXJUZXh0dXJlcyIsIl9wYXJzZXIiLCJKc29uU3RhbmRhcmRNYXRlcmlhbFBhcnNlciIsImxvYWQiLCJ1cmwiLCJjYWxsYmFjayIsIm9yaWdpbmFsIiwiaHR0cCIsImdldCIsInJldHJ5IiwibWF4UmV0cmllcyIsImVyciIsInJlc3BvbnNlIiwiX2VuZ2luZSIsIm9wZW4iLCJkYXRhIiwibWF0ZXJpYWwiLCJwYXJzZSIsIl9kYXRhIiwiX2NyZWF0ZVBsYWNlaG9sZGVycyIsInRleHR1cmVzIiwid2hpdGUiLCJncmF5IiwiYmxhY2siLCJub3JtYWwiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIlRleHR1cmUiLCJ3aWR0aCIsImhlaWdodCIsImZvcm1hdCIsIlBJWEVMRk9STUFUX1JHQkE4IiwibmFtZSIsInBpeGVscyIsImxvY2siLCJpIiwiYyIsInVubG9jayIsInBhdGNoIiwiYXNzZXQiLCJyZXNvdXJjZSIsIl9iaW5kQW5kQXNzaWduQXNzZXRzIiwib2ZmIiwiX29uQXNzZXRVbmxvYWQiLCJvbiIsInBhcmFtZXRlcnMiLCJjaHVua3MiLCJfYXNzaWduVGV4dHVyZSIsInBhcmFtZXRlck5hbWUiLCJtYXRlcmlhbEFzc2V0IiwidGV4dHVyZSIsIl9nZXRQbGFjZWhvbGRlclRleHR1cmUiLCJwbGFjZWhvbGRlciIsIl9hc3NpZ25QbGFjZWhvbGRlclRleHR1cmUiLCJfb25UZXh0dXJlTG9hZCIsInRleHR1cmVBc3NldCIsInVwZGF0ZSIsIl9vblRleHR1cmVBZGQiLCJfb25UZXh0dXJlUmVtb3ZlT3JVbmxvYWQiLCJfYXNzaWduQ3ViZW1hcCIsInByZWZpbHRlcmVkIiwic2xpY2UiLCJldmVyeSIsInQiLCJwcmVmaWx0ZXJlZEN1YmVtYXBzIiwiZW52QXRsYXMiLCJfb25DdWJlbWFwTG9hZCIsImN1YmVtYXBBc3NldCIsInJlc291cmNlcyIsImluaXRpYWxpemUiLCJfb25DdWJlbWFwQWRkIiwic2hhZGluZ01vZGVsIiwiU1BFQ1VMQVJfUEhPTkciLCJsb2FkRmFjZXMiLCJfb25DdWJlbWFwUmVtb3ZlT3JVbmxvYWQiLCJwcmVmaWx0ZXJlZEN1YmVNYXAxMjgiLCJtaWdyYXRlIiwicGF0aE1hcHBpbmciLCJtYXBwaW5nRm9ybWF0IiwiVEVYVFVSRVMiLCJzdGFuZGFyZE1hdGVyaWFsVGV4dHVyZVBhcmFtZXRlcnMiLCJhc3NldFJlZmVyZW5jZSIsImxlbmd0aCIsIl9hc3NldFJlZmVyZW5jZXMiLCJkYXRhQXNzZXRJZCIsIm1hdGVyaWFsVGV4dHVyZSIsImlzUGxhY2VIb2xkZXJUZXh0dXJlIiwiZGF0YVZhbGlkYXRlZCIsInZhbGlkYXRlZCIsIkFzc2V0UmVmZXJlbmNlIiwiYWRkIiwicmVtb3ZlIiwidW5sb2FkIiwiZ2V0QWJzb2x1dGVVcmwiLCJpZCIsIkNVQkVNQVBTIiwic3RhbmRhcmRNYXRlcmlhbEN1YmVtYXBQYXJhbWV0ZXJzIiwibG9hZGVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFhQSxNQUFNQSxlQUFlLEdBQUc7QUFDcEJDLEVBQUFBLEtBQUssRUFBRSxPQUFPO0FBQ2RDLEVBQUFBLFVBQVUsRUFBRSxNQUFNO0FBQ2xCQyxFQUFBQSxXQUFXLEVBQUUsTUFBTTtBQUNuQkMsRUFBQUEsb0JBQW9CLEVBQUUsT0FBTztBQUM3QkMsRUFBQUEsWUFBWSxFQUFFLE9BQU87QUFDckJDLEVBQUFBLFFBQVEsRUFBRSxNQUFNO0FBQ2hCQyxFQUFBQSxRQUFRLEVBQUUsT0FBTztBQUNqQkMsRUFBQUEsa0JB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
