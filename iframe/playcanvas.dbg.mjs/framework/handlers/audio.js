import { path } from '../../core/path.js';
import { Debug } from '../../core/debug.js';
import { Http, http } from '../../platform/net/http.js';
import { hasAudioContext } from '../../platform/audio/capabilities.js';
import { Sound } from '../../platform/sound/sound.js';
import { ResourceHandler } from './handler.js';

// checks if user is running IE
const ie = function () {
  if (typeof window === 'undefined') {
    // Node.js => return false
    return false;
  }
  const ua = window.navigator.userAgent;
  const msie = ua.indexOf('MSIE ');
  if (msie > 0) {
    // IE 10 or older => return version number
    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
  }
  const trident = ua.indexOf('Trident/');
  if (trident > 0) {
    // IE 11 => return version number
    const rv = ua.indexOf('rv:');
    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
  }
  return false;
}();
const supportedExtensions = ['.ogg', '.mp3', '.wav', '.mp4a', '.m4a', '.mp4', '.aac', '.opus'];

/**
 * Resource handler used for loading {@link Sound} resources.
 *
 * @category Sound
 */
class AudioHandler extends ResourceHandler {
  /**
   * Create a new AudioHandler instance.
   *
   * @param {import('../app-base.js').AppBase} app - The running {@link AppBase}.
   * @ignore
   */
  constructor(app) {
    super(app, 'audio');
    this.manager = app.soundManager;
    Debug.assert(this.manager, "AudioSourceComponentSystem cannot be created without sound manager");
  }
  _isSupported(url) {
    const ext = path.getExtension(url);
    return supportedExtensions.indexOf(ext) > -1;
  }
  load(url, callback) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }
    const success = function success(resource) {
      callback(null, new Sound(resource));
    };
    const error = function error(err) {
      let msg = 'Error loading audio url: ' + url.original;
      if (err) {
        msg += ': ' + (err.message || err);
      }
      console.warn(msg);
      callback(msg);
    };
    if (this._createSound) {
      if (!this._isSupported(url.original)) {
        error(`Audio format for ${url.original} not supported`);
        return;
      }
      this._createSound(url.load, success, error);
    } else {
      error(null);
    }
  }

  /**
   * Loads an audio asset using an AudioContext by URL and calls success or error with the
   * created resource or error respectively.
   *
   * @param {string} url - The url of the audio asset.
   * @param {Function} success - Function to be called if the audio asset was loaded or if we
   * just want to continue without errors even if the audio is not loaded.
   * @param {Function} error - Function to be called if there was an error while loading the
   * audio asset.
   * @private
   */
  _createSound(url, success, error) {
    if (hasAudioContext()) {
      const manager = this.manager;
      if (!manager.context) {
        error('Audio manager has no audio context');
        return;
      }

      // if this is a blob URL we need to set the response type to arraybuffer
      const options = {
        retry: this.maxRetries > 0,
        maxRetries: this.maxRetries
      };
      if (url.startsWith('blob:') || url.startsWith('data:')) {
        options.responseType = Http.ResponseType.ARRAY_BUFFER;
      }
      http.get(url, options, function (err, response) {
        if (err) {
          error(err);
          return;
        }
        manager.context.decodeAudioData(response, success, error);
      });
    } else {
      let audio = null;
      try {
        audio = new Audio();
      } catch (e) {
        // Some windows platforms will report Audio as available, then throw an exception when
        // the object is created.
        error('No support for Audio element');
        return;
      }

      // audio needs to be added to the DOM for IE
      if (ie) {
        document.body.appendChild(audio);
      }
      const onReady = function onReady() {
        audio.removeEventListener('canplaythrough', onReady);

        // remove from DOM no longer necessary
        if (ie) {
          document.body.removeChild(audio);
        }
        success(audio);
      };
      audio.onerror = function () {
        audio.onerror = null;

        // remove from DOM no longer necessary
        if (ie) {
          document.body.removeChild(audio);
        }
        error();
      };
      audio.addEventListener('canplaythrough', onReady);
      audio.src = url;
    }
  }
}

export { AudioHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVkaW8uanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvaGFuZGxlcnMvYXVkaW8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGF0aCB9IGZyb20gJy4uLy4uL2NvcmUvcGF0aC5qcyc7XG5pbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG5pbXBvcnQgeyBodHRwLCBIdHRwIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vbmV0L2h0dHAuanMnO1xuXG5pbXBvcnQgeyBoYXNBdWRpb0NvbnRleHQgfSBmcm9tICcuLi8uLi9wbGF0Zm9ybS9hdWRpby9jYXBhYmlsaXRpZXMuanMnO1xuXG5pbXBvcnQgeyBTb3VuZCB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL3NvdW5kL3NvdW5kLmpzJztcblxuaW1wb3J0IHsgUmVzb3VyY2VIYW5kbGVyIH0gZnJvbSAnLi9oYW5kbGVyLmpzJztcblxuLy8gY2hlY2tzIGlmIHVzZXIgaXMgcnVubmluZyBJRVxuY29uc3QgaWUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAvLyBOb2RlLmpzID0+IHJldHVybiBmYWxzZVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7XG5cbiAgICBjb25zdCBtc2llID0gdWEuaW5kZXhPZignTVNJRSAnKTtcbiAgICBpZiAobXNpZSA+IDApIHtcbiAgICAgICAgLy8gSUUgMTAgb3Igb2xkZXIgPT4gcmV0dXJuIHZlcnNpb24gbnVtYmVyXG4gICAgICAgIHJldHVybiBwYXJzZUludCh1YS5zdWJzdHJpbmcobXNpZSArIDUsIHVhLmluZGV4T2YoJy4nLCBtc2llKSksIDEwKTtcbiAgICB9XG5cbiAgICBjb25zdCB0cmlkZW50ID0gdWEuaW5kZXhPZignVHJpZGVudC8nKTtcbiAgICBpZiAodHJpZGVudCA+IDApIHtcbiAgICAgICAgLy8gSUUgMTEgPT4gcmV0dXJuIHZlcnNpb24gbnVtYmVyXG4gICAgICAgIGNvbnN0IHJ2ID0gdWEuaW5kZXhPZigncnY6Jyk7XG4gICAgICAgIHJldHVybiBwYXJzZUludCh1YS5zdWJzdHJpbmcocnYgKyAzLCB1YS5pbmRleE9mKCcuJywgcnYpKSwgMTApO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn0pKCk7XG5cbmNvbnN0IHN1cHBvcnRlZEV4dGVuc2lvbnMgPSBbXG4gICAgJy5vZ2cnLFxuICAgICcubXAzJyxcbiAgICAnLndhdicsXG4gICAgJy5tcDRhJyxcbiAgICAnLm00YScsXG4gICAgJy5tcDQnLFxuICAgICcuYWFjJyxcbiAgICAnLm9wdXMnXG5dO1xuXG4vKipcbiAqIFJlc291cmNlIGhhbmRsZXIgdXNlZCBmb3IgbG9hZGluZyB7QGxpbmsgU291bmR9IHJlc291cmNlcy5cbiAqXG4gKiBAY2F0ZWdvcnkgU291bmRcbiAqL1xuY2xhc3MgQXVkaW9IYW5kbGVyIGV4dGVuZHMgUmVzb3VyY2VIYW5kbGVyIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgQXVkaW9IYW5kbGVyIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gYXBwIC0gVGhlIHJ1bm5pbmcge0BsaW5rIEFwcEJhc2V9LlxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgc3VwZXIoYXBwLCAnYXVkaW8nKTtcblxuICAgICAgICB0aGlzLm1hbmFnZXIgPSBhcHAuc291bmRNYW5hZ2VyO1xuICAgICAgICBEZWJ1Zy5hc3NlcnQodGhpcy5tYW5hZ2VyLCBcIkF1ZGlvU291cmNlQ29tcG9uZW50U3lzdGVtIGNhbm5vdCBiZSBjcmVhdGVkIHdpdGhvdXQgc291bmQgbWFuYWdlclwiKTtcbiAgICB9XG5cbiAgICBfaXNTdXBwb3J0ZWQodXJsKSB7XG4gICAgICAgIGNvbnN0IGV4dCA9IHBhdGguZ2V0RXh0ZW5zaW9uKHVybCk7XG5cbiAgICAgICAgcmV0dXJuIHN1cHBvcnRlZEV4dGVuc2lvbnMuaW5kZXhPZihleHQpID4gLTE7XG4gICAgfVxuXG4gICAgbG9hZCh1cmwsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdXJsID0ge1xuICAgICAgICAgICAgICAgIGxvYWQ6IHVybCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogdXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGZ1bmN0aW9uIChyZXNvdXJjZSkge1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgbmV3IFNvdW5kKHJlc291cmNlKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBsZXQgbXNnID0gJ0Vycm9yIGxvYWRpbmcgYXVkaW8gdXJsOiAnICsgdXJsLm9yaWdpbmFsO1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIG1zZyArPSAnOiAnICsgKGVyci5tZXNzYWdlIHx8IGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLndhcm4obXNnKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG1zZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoaXMuX2NyZWF0ZVNvdW5kKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2lzU3VwcG9ydGVkKHVybC5vcmlnaW5hbCkpIHtcbiAgICAgICAgICAgICAgICBlcnJvcihgQXVkaW8gZm9ybWF0IGZvciAke3VybC5vcmlnaW5hbH0gbm90IHN1cHBvcnRlZGApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlU291bmQodXJsLmxvYWQsIHN1Y2Nlc3MsIGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVycm9yKG51bGwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZHMgYW4gYXVkaW8gYXNzZXQgdXNpbmcgYW4gQXVkaW9Db250ZXh0IGJ5IFVSTCBhbmQgY2FsbHMgc3VjY2VzcyBvciBlcnJvciB3aXRoIHRoZVxuICAgICAqIGNyZWF0ZWQgcmVzb3VyY2Ugb3IgZXJyb3IgcmVzcGVjdGl2ZWx5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFRoZSB1cmwgb2YgdGhlIGF1ZGlvIGFzc2V0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3MgLSBGdW5jdGlvbiB0byBiZSBjYWxsZWQgaWYgdGhlIGF1ZGlvIGFzc2V0IHdhcyBsb2FkZWQgb3IgaWYgd2VcbiAgICAgKiBqdXN0IHdhbnQgdG8gY29udGludWUgd2l0aG91dCBlcnJvcnMgZXZlbiBpZiB0aGUgYXVkaW8gaXMgbm90IGxvYWRlZC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvciAtIEZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgbG9hZGluZyB0aGVcbiAgICAgKiBhdWRpbyBhc3NldC5cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jcmVhdGVTb3VuZCh1cmwsIHN1Y2Nlc3MsIGVycm9yKSB7XG4gICAgICAgIGlmIChoYXNBdWRpb0NvbnRleHQoKSkge1xuICAgICAgICAgICAgY29uc3QgbWFuYWdlciA9IHRoaXMubWFuYWdlcjtcblxuICAgICAgICAgICAgaWYgKCFtYW5hZ2VyLmNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBlcnJvcignQXVkaW8gbWFuYWdlciBoYXMgbm8gYXVkaW8gY29udGV4dCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJsb2IgVVJMIHdlIG5lZWQgdG8gc2V0IHRoZSByZXNwb25zZSB0eXBlIHRvIGFycmF5YnVmZmVyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHJldHJ5OiB0aGlzLm1heFJldHJpZXMgPiAwLFxuICAgICAgICAgICAgICAgIG1heFJldHJpZXM6IHRoaXMubWF4UmV0cmllc1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHVybC5zdGFydHNXaXRoKCdibG9iOicpIHx8IHVybC5zdGFydHNXaXRoKCdkYXRhOicpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5yZXNwb25zZVR5cGUgPSBIdHRwLlJlc3BvbnNlVHlwZS5BUlJBWV9CVUZGRVI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGh0dHAuZ2V0KHVybCwgb3B0aW9ucywgZnVuY3Rpb24gKGVyciwgcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtYW5hZ2VyLmNvbnRleHQuZGVjb2RlQXVkaW9EYXRhKHJlc3BvbnNlLCBzdWNjZXNzLCBlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBhdWRpbyA9IG51bGw7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXVkaW8gPSBuZXcgQXVkaW8oKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBTb21lIHdpbmRvd3MgcGxhdGZvcm1zIHdpbGwgcmVwb3J0IEF1ZGlvIGFzIGF2YWlsYWJsZSwgdGhlbiB0aHJvdyBhbiBleGNlcHRpb24gd2hlblxuICAgICAgICAgICAgICAgIC8vIHRoZSBvYmplY3QgaXMgY3JlYXRlZC5cbiAgICAgICAgICAgICAgICBlcnJvcignTm8gc3VwcG9ydCBmb3IgQXVkaW8gZWxlbWVudCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYXVkaW8gbmVlZHMgdG8gYmUgYWRkZWQgdG8gdGhlIERPTSBmb3IgSUVcbiAgICAgICAgICAgIGlmIChpZSkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYXVkaW8pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBvblJlYWR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGF1ZGlvLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgb25SZWFkeSk7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgZnJvbSBET00gbm8gbG9uZ2VyIG5lY2Vzc2FyeVxuICAgICAgICAgICAgICAgIGlmIChpZSkge1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGF1ZGlvKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzdWNjZXNzKGF1ZGlvKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF1ZGlvLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXVkaW8ub25lcnJvciA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgZnJvbSBET00gbm8gbG9uZ2VyIG5lY2Vzc2FyeVxuICAgICAgICAgICAgICAgIGlmIChpZSkge1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGF1ZGlvKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBlcnJvcigpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCBvblJlYWR5KTtcbiAgICAgICAgICAgIGF1ZGlvLnNyYyA9IHVybDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgQXVkaW9IYW5kbGVyIH07XG4iXSwibmFtZXMiOlsiaWUiLCJ3aW5kb3ciLCJ1YSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm1zaWUiLCJpbmRleE9mIiwicGFyc2VJbnQiLCJzdWJzdHJpbmciLCJ0cmlkZW50IiwicnYiLCJzdXBwb3J0ZWRFeHRlbnNpb25zIiwiQXVkaW9IYW5kbGVyIiwiUmVzb3VyY2VIYW5kbGVyIiwiY29uc3RydWN0b3IiLCJhcHAiLCJtYW5hZ2VyIiwic291bmRNYW5hZ2VyIiwiRGVidWciLCJhc3NlcnQiLCJfaXNTdXBwb3J0ZWQiLCJ1cmwiLCJleHQiLCJwYXRoIiwiZ2V0RXh0ZW5zaW9uIiwibG9hZCIsImNhbGxiYWNrIiwib3JpZ2luYWwiLCJzdWNjZXNzIiwicmVzb3VyY2UiLCJTb3VuZCIsImVycm9yIiwiZXJyIiwibXNnIiwibWVzc2FnZSIsImNvbnNvbGUiLCJ3YXJuIiwiX2NyZWF0ZVNvdW5kIiwiaGFzQXVkaW9Db250ZXh0IiwiY29udGV4dCIsIm9wdGlvbnMiLCJyZXRyeSIsIm1heFJldHJpZXMiLCJzdGFydHNXaXRoIiwicmVzcG9uc2VUeXBlIiwiSHR0cCIsIlJlc3BvbnNlVHlwZSIsIkFSUkFZX0JVRkZFUiIsImh0dHAiLCJnZXQiLCJyZXNwb25zZSIsImRlY29kZUF1ZGlvRGF0YSIsImF1ZGlvIiwiQXVkaW8iLCJlIiwiZG9jdW1lbnQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJvblJlYWR5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlbW92ZUNoaWxkIiwib25lcnJvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzcmMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFXQTtBQUNBLE1BQU1BLEVBQUUsR0FBSSxZQUFZO0FBQ3BC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
