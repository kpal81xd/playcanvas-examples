import { http } from '../../platform/net/http.js';

class SceneUtils {
  /**
   * Loads the scene JSON file from a URL.
   *
   * @param {string} url - URL to scene JSON.
   * @param {number} maxRetries - Number of http load retry attempts.
   * @param {Function} callback - The callback to the JSON file is loaded.
   */
  static load(url, maxRetries, callback) {
    if (typeof url === 'string') {
      url = {
        load: url,
        original: url
      };
    }
    http.get(url.load, {
      retry: maxRetries > 0,
      maxRetries: maxRetries
    }, function (err, response) {
      if (!err) {
        callback(err, response);
      } else {
        let errMsg = 'Error while loading scene JSON ' + url.original;
        if (err.message) {
          errMsg += ': ' + err.message;
          if (err.stack) {
            errMsg += '\n' + err.stack;
          }
        } else {
          errMsg += ': ' + err;
        }
        callback(errMsg);
      }
    });
  }
}

export { SceneUtils };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NlbmUtdXRpbHMuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvaGFuZGxlcnMvc2NlbmUtdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaHR0cCB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL25ldC9odHRwLmpzJztcblxuY2xhc3MgU2NlbmVVdGlscyB7XG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhlIHNjZW5lIEpTT04gZmlsZSBmcm9tIGEgVVJMLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIFVSTCB0byBzY2VuZSBKU09OLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtYXhSZXRyaWVzIC0gTnVtYmVyIG9mIGh0dHAgbG9hZCByZXRyeSBhdHRlbXB0cy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIFRoZSBjYWxsYmFjayB0byB0aGUgSlNPTiBmaWxlIGlzIGxvYWRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgbG9hZCh1cmwsIG1heFJldHJpZXMsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdXJsID0ge1xuICAgICAgICAgICAgICAgIGxvYWQ6IHVybCxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbDogdXJsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaHR0cC5nZXQodXJsLmxvYWQsIHtcbiAgICAgICAgICAgIHJldHJ5OiBtYXhSZXRyaWVzID4gMCxcbiAgICAgICAgICAgIG1heFJldHJpZXM6IG1heFJldHJpZXNcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVyciwgcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyLCByZXNwb25zZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBlcnJNc2cgPSAnRXJyb3Igd2hpbGUgbG9hZGluZyBzY2VuZSBKU09OICcgKyB1cmwub3JpZ2luYWw7XG4gICAgICAgICAgICAgICAgaWYgKGVyci5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGVyck1zZyArPSAnOiAnICsgZXJyLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIuc3RhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVyck1zZyArPSAnXFxuJyArIGVyci5zdGFjaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVyck1zZyArPSAnOiAnICsgZXJyO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVyck1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgU2NlbmVVdGlscyB9O1xuIl0sIm5hbWVzIjpbIlNjZW5lVXRpbHMiLCJsb2FkIiwidXJsIiwibWF4UmV0cmllcyIsImNhbGxiYWNrIiwib3JpZ2luYWwiLCJodHRwIiwiZ2V0IiwicmV0cnkiLCJlcnIiLCJyZXNwb25zZSIsImVyck1zZyIsIm1lc3NhZ2UiLCJzdGFjayJdLCJtYXBwaW5ncyI6Ijs7QUFFQSxNQUFNQSxVQUFVLENBQUM7QUFDYjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJLEVBQUEsT0FBT0MsSUFBSUEsQ0FBQ0MsR0FBRyxFQUFFQyxVQUFVLEVBQUVDLFFBQVEsRUFBRTtBQUNuQyxJQUFBLElBQUksT0FBT0YsR0FBRyxLQUFLLFFBQVEsRUFBRTtBQUN6QkEsTUFBQUEsR0FBRyxHQUFHO0FBQ0ZELFFBQUFBLElBQUksRUFBRUMsR0FBRztBQUNURyxRQUFBQSxRQUFRLEVBQUVILEdBQUFBO09BQ2IsQ0FBQTtBQUNMLEtBQUE7QUFFQUksSUFBQUEsSUFBSSxDQUFDQyxHQUFHLENBQUNMLEdBQUcsQ0FBQ0QsSUFBSSxFQUFFO01BQ2ZPLEtBQUssRUFBRUwsVUFBVSxHQUFHLENBQUM7QUFDckJBLE1BQUFBLFVBQVUsRUFBRUEsVUFBQUE7QUFDaEIsS0FBQyxFQUFFLFVBQVVNLEdBQUcsRUFBRUMsUUFBUSxFQUFFO01BQ3hCLElBQUksQ0FBQ0QsR0FBRyxFQUFFO0FBQ05MLFFBQUFBLFFBQVEsQ0FBQ0ssR0FBRyxFQUFFQyxRQUFRLENBQUMsQ0FBQTtBQUMzQixPQUFDLE1BQU07QUFDSCxRQUFBLElBQUlDLE1BQU0sR0FBRyxpQ0FBaUMsR0FBR1QsR0FBRyxDQUFDRyxRQUFRLENBQUE7UUFDN0QsSUFBSUksR0FBRyxDQUFDRyxPQUFPLEVBQUU7QUFDYkQsVUFBQUEsTUFBTSxJQUFJLElBQUksR0FBR0YsR0FBRyxDQUFDRyxPQUFPLENBQUE7VUFDNUIsSUFBSUgsR0FBRyxDQUFDSSxLQUFLLEVBQUU7QUFDWEYsWUFBQUEsTUFBTSxJQUFJLElBQUksR0FBR0YsR0FBRyxDQUFDSSxLQUFLLENBQUE7QUFDOUIsV0FBQTtBQUNKLFNBQUMsTUFBTTtVQUNIRixNQUFNLElBQUksSUFBSSxHQUFHRixHQUFHLENBQUE7QUFDeEIsU0FBQTtRQUVBTCxRQUFRLENBQUNPLE1BQU0sQ0FBQyxDQUFBO0FBQ3BCLE9BQUE7QUFDSixLQUFDLENBQUMsQ0FBQTtBQUNOLEdBQUE7QUFDSjs7OzsifQ==
