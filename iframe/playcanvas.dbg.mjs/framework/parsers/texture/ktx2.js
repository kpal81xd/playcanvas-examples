import { extends as _extends } from '../../../_virtual/_rollupPluginBabelHelpers.js';
import { Debug } from '../../../core/debug.js';
import { ReadStream } from '../../../core/read-stream.js';
import { TEXHINT_ASSET, ADDRESS_CLAMP_TO_EDGE, ADDRESS_REPEAT } from '../../../platform/graphics/constants.js';
import { Texture } from '../../../platform/graphics/texture.js';
import { Asset } from '../../asset/asset.js';
import { basisTranscode } from '../../handlers/basis.js';

/** @typedef {import('../../handlers/texture.js').TextureParser} TextureParser */

const KHRConstants = {
  KHR_DF_MODEL_ETC1S: 163,
  KHR_DF_MODEL_UASTC: 166
};

/**
 * Texture parser for ktx2 files.
 *
 * @implements {TextureParser}
 * @ignore
 */
class Ktx2Parser {
  constructor(registry, device) {
    this.maxRetries = 0;
    this.device = device;
  }
  load(url, callback, asset) {
    Asset.fetchArrayBuffer(url.load, (err, result) => {
      if (err) {
        callback(err, result);
      } else {
        this.parse(result, url, callback, asset);
      }
    }, asset, this.maxRetries);
  }
  open(url, data, device, textureOptions = {}) {
    const texture = new Texture(device, _extends({
      name: url,
      profilerHint: TEXHINT_ASSET,
      addressU: data.cubemap ? ADDRESS_CLAMP_TO_EDGE : ADDRESS_REPEAT,
      addressV: data.cubemap ? ADDRESS_CLAMP_TO_EDGE : ADDRESS_REPEAT,
      width: data.width,
      height: data.height,
      format: data.format,
      cubemap: data.cubemap,
      levels: data.levels
    }, textureOptions));
    texture.upload();
    return texture;
  }
  parse(arraybuffer, url, callback, asset) {
    const rs = new ReadStream(arraybuffer);

    // check magic header bits:  '«', 'K', 'T', 'X', ' ', '2', '0', '»', '\r', '\n', '\x1A', '\n'\
    const magic = [rs.readU32be(), rs.readU32be(), rs.readU32be()];
    if (magic[0] !== 0xAB4B5458 || magic[1] !== 0x203230BB || magic[2] !== 0x0D0A1A0A) {
      Debug.warn('Invalid definition header found in KTX2 file. Expected 0xAB4B5458, 0x203131BB, 0x0D0A1A0A');
      return null;
    }

    // unpack header
    const header = {
      vkFormat: rs.readU32(),
      typeSize: rs.readU32(),
      pixelWidth: rs.readU32(),
      pixelHeight: rs.readU32(),
      pixelDepth: rs.readU32(),
      layerCount: rs.readU32(),
      faceCount: rs.readU32(),
      levelCount: rs.readU32(),
      supercompressionScheme: rs.readU32()
    };

    // unpack index
    const index = {
      dfdByteOffset: rs.readU32(),
      dfdByteLength: rs.readU32(),
      kvdByteOffset: rs.readU32(),
      kvdByteLength: rs.readU32(),
      sgdByteOffset: rs.readU64(),
      sgdByteLength: rs.readU64()
    };

    // unpack levels
    const levels = [];
    for (let i = 0; i < Math.max(1, header.levelCount); ++i) {
      levels.push({
        byteOffset: rs.readU64(),
        byteLength: rs.readU64(),
        uncompressedByteLength: rs.readU64()
      });
    }

    // unpack data format descriptor
    const dfdTotalSize = rs.readU32();
    if (dfdTotalSize !== index.kvdByteOffset - index.dfdByteOffset) {
      Debug.warn('Invalid file data encountered.');
      return null;
    }
    rs.skip(8);
    const colorModel = rs.readU8();
    rs.skip(index.dfdByteLength - 9);

    // skip key/value pairs
    rs.skip(index.kvdByteLength);
    if (header.supercompressionScheme === 1 || colorModel === KHRConstants.KHR_DF_MODEL_UASTC) {
      var _asset$file;
      // assume for now all super compressed images are basis
      const basisModuleFound = basisTranscode(this.device, url.load, arraybuffer, callback, {
        isGGGR: ((asset == null || (_asset$file = asset.file) == null || (_asset$file = _asset$file.variants) == null || (_asset$file = _asset$file.basis) == null ? void 0 : _asset$file.opt) & 8) !== 0,
        isKTX2: true
      });
      if (!basisModuleFound) {
        callback('Basis module not found. Asset "' + asset.name + '" basis texture variant will not be loaded.');
      }
    } else {
      // TODO: load non-supercompressed formats
      callback('unsupported KTX2 pixel format');
    }
  }
}

export { Ktx2Parser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3R4Mi5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2ZyYW1ld29yay9wYXJzZXJzL3RleHR1cmUva3R4Mi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4uLy4uLy4uL2NvcmUvZGVidWcuanMnO1xuaW1wb3J0IHsgUmVhZFN0cmVhbSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvcmVhZC1zdHJlYW0uanMnO1xuXG5pbXBvcnQgeyBBRERSRVNTX0NMQU1QX1RPX0VER0UsIEFERFJFU1NfUkVQRUFULCBURVhISU5UX0FTU0VUIH0gZnJvbSAnLi4vLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IFRleHR1cmUgfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy90ZXh0dXJlLmpzJztcblxuaW1wb3J0IHsgQXNzZXQgfSBmcm9tICcuLi8uLi9hc3NldC9hc3NldC5qcyc7XG5pbXBvcnQgeyBiYXNpc1RyYW5zY29kZSB9IGZyb20gJy4uLy4uL2hhbmRsZXJzL2Jhc2lzLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2hhbmRsZXJzL3RleHR1cmUuanMnKS5UZXh0dXJlUGFyc2VyfSBUZXh0dXJlUGFyc2VyICovXG5cbmNvbnN0IEtIUkNvbnN0YW50cyA9IHtcbiAgICBLSFJfREZfTU9ERUxfRVRDMVM6IDE2MyxcbiAgICBLSFJfREZfTU9ERUxfVUFTVEM6IDE2NlxufTtcblxuLyoqXG4gKiBUZXh0dXJlIHBhcnNlciBmb3Iga3R4MiBmaWxlcy5cbiAqXG4gKiBAaW1wbGVtZW50cyB7VGV4dHVyZVBhcnNlcn1cbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgS3R4MlBhcnNlciB7XG4gICAgY29uc3RydWN0b3IocmVnaXN0cnksIGRldmljZSkge1xuICAgICAgICB0aGlzLm1heFJldHJpZXMgPSAwO1xuICAgICAgICB0aGlzLmRldmljZSA9IGRldmljZTtcbiAgICB9XG5cbiAgICBsb2FkKHVybCwgY2FsbGJhY2ssIGFzc2V0KSB7XG4gICAgICAgIEFzc2V0LmZldGNoQXJyYXlCdWZmZXIodXJsLmxvYWQsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVyciwgcmVzdWx0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJzZShyZXN1bHQsIHVybCwgY2FsbGJhY2ssIGFzc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgYXNzZXQsIHRoaXMubWF4UmV0cmllcyk7XG4gICAgfVxuXG4gICAgb3Blbih1cmwsIGRhdGEsIGRldmljZSwgdGV4dHVyZU9wdGlvbnMgPSB7fSkge1xuICAgICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRleHR1cmUoZGV2aWNlLCB7XG4gICAgICAgICAgICBuYW1lOiB1cmwsXG4gICAgICAgICAgICAvLyAjaWYgX1BST0ZJTEVSXG4gICAgICAgICAgICBwcm9maWxlckhpbnQ6IFRFWEhJTlRfQVNTRVQsXG4gICAgICAgICAgICAvLyAjZW5kaWZcbiAgICAgICAgICAgIGFkZHJlc3NVOiBkYXRhLmN1YmVtYXAgPyBBRERSRVNTX0NMQU1QX1RPX0VER0UgOiBBRERSRVNTX1JFUEVBVCxcbiAgICAgICAgICAgIGFkZHJlc3NWOiBkYXRhLmN1YmVtYXAgPyBBRERSRVNTX0NMQU1QX1RPX0VER0UgOiBBRERSRVNTX1JFUEVBVCxcbiAgICAgICAgICAgIHdpZHRoOiBkYXRhLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBkYXRhLmhlaWdodCxcbiAgICAgICAgICAgIGZvcm1hdDogZGF0YS5mb3JtYXQsXG4gICAgICAgICAgICBjdWJlbWFwOiBkYXRhLmN1YmVtYXAsXG4gICAgICAgICAgICBsZXZlbHM6IGRhdGEubGV2ZWxzLFxuXG4gICAgICAgICAgICAuLi50ZXh0dXJlT3B0aW9uc1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXh0dXJlLnVwbG9hZCgpO1xuXG4gICAgICAgIHJldHVybiB0ZXh0dXJlO1xuICAgIH1cblxuICAgIHBhcnNlKGFycmF5YnVmZmVyLCB1cmwsIGNhbGxiYWNrLCBhc3NldCkge1xuICAgICAgICBjb25zdCBycyA9IG5ldyBSZWFkU3RyZWFtKGFycmF5YnVmZmVyKTtcblxuICAgICAgICAvLyBjaGVjayBtYWdpYyBoZWFkZXIgYml0czogICfCqycsICdLJywgJ1QnLCAnWCcsICcgJywgJzInLCAnMCcsICfCuycsICdcXHInLCAnXFxuJywgJ1xceDFBJywgJ1xcbidcXFxuICAgICAgICBjb25zdCBtYWdpYyA9IFtycy5yZWFkVTMyYmUoKSwgcnMucmVhZFUzMmJlKCksIHJzLnJlYWRVMzJiZSgpXTtcbiAgICAgICAgaWYgKG1hZ2ljWzBdICE9PSAweEFCNEI1NDU4IHx8IG1hZ2ljWzFdICE9PSAweDIwMzIzMEJCIHx8IG1hZ2ljWzJdICE9PSAweDBEMEExQTBBKSB7XG4gICAgICAgICAgICBEZWJ1Zy53YXJuKCdJbnZhbGlkIGRlZmluaXRpb24gaGVhZGVyIGZvdW5kIGluIEtUWDIgZmlsZS4gRXhwZWN0ZWQgMHhBQjRCNTQ1OCwgMHgyMDMxMzFCQiwgMHgwRDBBMUEwQScpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1bnBhY2sgaGVhZGVyXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IHtcbiAgICAgICAgICAgIHZrRm9ybWF0OiBycy5yZWFkVTMyKCksXG4gICAgICAgICAgICB0eXBlU2l6ZTogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAgcGl4ZWxXaWR0aDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAgcGl4ZWxIZWlnaHQ6IHJzLnJlYWRVMzIoKSxcbiAgICAgICAgICAgIHBpeGVsRGVwdGg6IHJzLnJlYWRVMzIoKSxcbiAgICAgICAgICAgIGxheWVyQ291bnQ6IHJzLnJlYWRVMzIoKSxcbiAgICAgICAgICAgIGZhY2VDb3VudDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAgbGV2ZWxDb3VudDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAgc3VwZXJjb21wcmVzc2lvblNjaGVtZTogcnMucmVhZFUzMigpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdW5wYWNrIGluZGV4XG4gICAgICAgIGNvbnN0IGluZGV4ID0ge1xuICAgICAgICAgICAgZGZkQnl0ZU9mZnNldDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAgZGZkQnl0ZUxlbmd0aDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAga3ZkQnl0ZU9mZnNldDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAga3ZkQnl0ZUxlbmd0aDogcnMucmVhZFUzMigpLFxuICAgICAgICAgICAgc2dkQnl0ZU9mZnNldDogcnMucmVhZFU2NCgpLFxuICAgICAgICAgICAgc2dkQnl0ZUxlbmd0aDogcnMucmVhZFU2NCgpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdW5wYWNrIGxldmVsc1xuICAgICAgICBjb25zdCBsZXZlbHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1heCgxLCBoZWFkZXIubGV2ZWxDb3VudCk7ICsraSkge1xuICAgICAgICAgICAgbGV2ZWxzLnB1c2goe1xuICAgICAgICAgICAgICAgIGJ5dGVPZmZzZXQ6IHJzLnJlYWRVNjQoKSxcbiAgICAgICAgICAgICAgICBieXRlTGVuZ3RoOiBycy5yZWFkVTY0KCksXG4gICAgICAgICAgICAgICAgdW5jb21wcmVzc2VkQnl0ZUxlbmd0aDogcnMucmVhZFU2NCgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHVucGFjayBkYXRhIGZvcm1hdCBkZXNjcmlwdG9yXG4gICAgICAgIGNvbnN0IGRmZFRvdGFsU2l6ZSA9IHJzLnJlYWRVMzIoKTtcbiAgICAgICAgaWYgKGRmZFRvdGFsU2l6ZSAhPT0gaW5kZXgua3ZkQnl0ZU9mZnNldCAtIGluZGV4LmRmZEJ5dGVPZmZzZXQpIHtcbiAgICAgICAgICAgIERlYnVnLndhcm4oJ0ludmFsaWQgZmlsZSBkYXRhIGVuY291bnRlcmVkLicpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBycy5za2lwKDgpO1xuICAgICAgICBjb25zdCBjb2xvck1vZGVsID0gcnMucmVhZFU4KCk7XG4gICAgICAgIHJzLnNraXAoaW5kZXguZGZkQnl0ZUxlbmd0aCAtIDkpO1xuXG4gICAgICAgIC8vIHNraXAga2V5L3ZhbHVlIHBhaXJzXG4gICAgICAgIHJzLnNraXAoaW5kZXgua3ZkQnl0ZUxlbmd0aCk7XG5cbiAgICAgICAgaWYgKGhlYWRlci5zdXBlcmNvbXByZXNzaW9uU2NoZW1lID09PSAxIHx8IGNvbG9yTW9kZWwgPT09IEtIUkNvbnN0YW50cy5LSFJfREZfTU9ERUxfVUFTVEMpIHtcbiAgICAgICAgICAgIC8vIGFzc3VtZSBmb3Igbm93IGFsbCBzdXBlciBjb21wcmVzc2VkIGltYWdlcyBhcmUgYmFzaXNcbiAgICAgICAgICAgIGNvbnN0IGJhc2lzTW9kdWxlRm91bmQgPSBiYXNpc1RyYW5zY29kZShcbiAgICAgICAgICAgICAgICB0aGlzLmRldmljZSxcbiAgICAgICAgICAgICAgICB1cmwubG9hZCxcbiAgICAgICAgICAgICAgICBhcnJheWJ1ZmZlcixcbiAgICAgICAgICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlzR0dHUjogKGFzc2V0Py5maWxlPy52YXJpYW50cz8uYmFzaXM/Lm9wdCAmIDgpICE9PSAwLFxuICAgICAgICAgICAgICAgICAgICBpc0tUWDI6IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoIWJhc2lzTW9kdWxlRm91bmQpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygnQmFzaXMgbW9kdWxlIG5vdCBmb3VuZC4gQXNzZXQgXCInICsgYXNzZXQubmFtZSArICdcIiBiYXNpcyB0ZXh0dXJlIHZhcmlhbnQgd2lsbCBub3QgYmUgbG9hZGVkLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVE9ETzogbG9hZCBub24tc3VwZXJjb21wcmVzc2VkIGZvcm1hdHNcbiAgICAgICAgICAgIGNhbGxiYWNrKCd1bnN1cHBvcnRlZCBLVFgyIHBpeGVsIGZvcm1hdCcpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQge1xuICAgIEt0eDJQYXJzZXJcbn07XG4iXSwibmFtZXMiOlsiS0hSQ29uc3RhbnRzIiwiS0hSX0RGX01PREVMX0VUQzFTIiwiS0hSX0RGX01PREVMX1VBU1RDIiwiS3R4MlBhcnNlciIsImNvbnN0cnVjdG9yIiwicmVnaXN0cnkiLCJkZXZpY2UiLCJtYXhSZXRyaWVzIiwibG9hZCIsInVybCIsImNhbGxiYWNrIiwiYXNzZXQiLCJBc3NldCIsImZldGNoQXJyYXlCdWZmZXIiLCJlcnIiLCJyZXN1bHQiLCJwYXJzZSIsIm9wZW4iLCJkYXRhIiwidGV4dHVyZU9wdGlvbnMiLCJ0ZXh0dXJlIiwiVGV4dHVyZSIsIl9leHRlbmRzIiwibmFtZSIsInByb2ZpbGVySGludCIsIlRFWEhJTlRfQVNTRVQiLCJhZGRyZXNzVSIsImN1YmVtYXAiLCJBRERSRVNTX0NMQU1QX1RPX0VER0UiLCJBRERSRVNTX1JFUEVBVCIsImFkZHJlc3NWIiwid2lkdGgiLCJoZWlnaHQiLCJmb3JtYXQiLCJsZXZlbHMiLCJ1cGxvYWQiLCJhcnJheWJ1ZmZlciIsInJzIiwiUmVhZFN0cmVhbSIsIm1hZ2ljIiwicmVhZFUzMmJlIiwiRGVidWciLCJ3YXJuIiwiaGVhZGVyIiwidmtGb3JtYXQiLCJyZWFkVTMyIiwidHlwZVNpemUiLCJwaXhlbFdpZHRoIiwicGl4ZWxIZWlnaHQiLCJwaXhlbERlcHRoIiwibGF5ZXJDb3VudCIsImZhY2VDb3VudCIsImxldmVsQ291bnQiLCJzdXBlcmNvbXByZXNzaW9uU2NoZW1lIiwiaW5kZXgiLCJkZmRCeXRlT2Zmc2V0IiwiZGZkQnl0ZUxlbmd0aCIsImt2ZEJ5dGVPZmZzZXQiLCJrdmRCeXRlTGVuZ3RoIiwic2dkQnl0ZU9mZnNldCIsInJlYWRVNjQiLCJzZ2RCeXRlTGVuZ3RoIiwiaSIsIk1hdGgiLCJtYXgiLCJwdXNoIiwiYnl0ZU9mZnNldCIsImJ5dGVMZW5ndGgiLCJ1bmNvbXByZXNzZWRCeXRlTGVuZ3RoIiwiZGZkVG90YWxTaXplIiwic2tpcCIsImNvbG9yTW9kZWwiLCJyZWFkVTgiLCJfYXNzZXQkZmlsZSIsImJhc2lzTW9kdWxlRm91bmQiLCJiYXNpc1RyYW5zY29kZSIsImlzR0dHUiIsImZpbGUiLCJ2YXJpYW50cyIsImJhc2lzIiwib3B0IiwiaXNLVFgyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQVNBOztBQUVBLE1BQU1BLFlBQVksR0FBRztBQUNqQkMsRUFBQUEsa0JBQWtCLEVBQUUsR0FBRztBQUN2QkMsRUFBQUEsa0JBQWtCLEVBQUUsR0FBQTtBQUN4QixDQUFDLENBQUE7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTUMsVUFBVSxDQUFDO0FBQ2JDLEVBQUFBLFdBQVdBLENBQUNDLFFBQVEsRUFBRUMsTUFBTSxFQUFFO0lBQzFCLElBQUksQ0FBQ0MsVUFBVSxHQUFHLENBQUMsQ0FBQTtJQUNuQixJQUFJLENBQUNELE1BQU0sR0FBR0EsTUFBTSxDQUFBO0FBQ3hCLEdBQUE7QUFFQUUsRUFBQUEsSUFBSUEsQ0FBQ0MsR0FBRyxFQUFFQyxRQUFRLEVBQUVDLEtBQUssRUFBRTtJQUN2QkMsS0FBSyxDQUFDQyxnQkFBZ0IsQ0FBQ0osR0FBRyxDQUFDRCxJQUFJLEVBQUUsQ0FBQ00sR0FBRyxFQUFFQyxNQUFNLEtBQUs7QUFDOUMsTUFBQSxJQUFJRCxHQUFHLEVBQUU7QUFDTEosUUFBQUEsUUFBUSxDQUFDSSxHQUFHLEVBQUVDLE1BQU0sQ0FBQyxDQUFBO0FBQ3pCLE9BQUMsTUFBTTtRQUNILElBQUksQ0FBQ0MsS0FBSyxDQUFD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
