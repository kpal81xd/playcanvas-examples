import { Debug } from '../../../core/debug.js';
import { hasAudioContext } from '../../../platform/audio/capabilities.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { SoundComponent } from './component.js';
import { SoundComponentData } from './data.js';

const _schema = ['enabled'];

/**
 * Manages creation of {@link SoundComponent}s.
 *
 * @augments ComponentSystem
 * @category Sound
 */
class SoundComponentSystem extends ComponentSystem {
  /**
   * Create a SoundComponentSystem.
   *
   * @param {import('../../app-base.js').AppBase} app - The Application.
   * @hideconstructor
   */
  constructor(app) {
    super(app);
    this.id = 'sound';
    this.ComponentType = SoundComponent;
    this.DataType = SoundComponentData;
    this.schema = _schema;

    /**
     * Gets / sets the sound manager.
     *
     * @type {import('../../../platform/sound/manager.js').SoundManager}
     */
    this.manager = app.soundManager;
    Debug.assert(this.manager, "AudioSourceComponentSystem cannot be created without sound manager");
    this.app.systems.on('update', this.onUpdate, this);
    this.on('beforeremove', this.onBeforeRemove, this);
  }

  /**
   * Sets / gets the volume for the entire Sound system. All sounds will have their volume
   * multiplied by this value. Valid between [0, 1].
   *
   * @type {number}
   */
  set volume(volume) {
    this.manager.volume = volume;
  }
  get volume() {
    return this.manager.volume;
  }

  /**
   * Gets the AudioContext currently used by the sound manager. Requires Web Audio API support.
   * Returns null if the device does not support the Web Audio API.
   *
   * @type {AudioContext|null}
   */
  get context() {
    if (!hasAudioContext()) {
      Debug.warn('WARNING: Audio context is not supported on this browser');
      return null;
    }
    return this.manager.context;
  }
  initializeComponentData(component, data, properties) {
    properties = ['volume', 'pitch', 'positional', 'refDistance', 'maxDistance', 'rollOffFactor', 'distanceModel', 'slots'];
    for (let i = 0; i < properties.length; i++) {
      if (data.hasOwnProperty(properties[i])) {
        component[properties[i]] = data[properties[i]];
      }
    }
    super.initializeComponentData(component, data, ['enabled']);
  }
  cloneComponent(entity, clone) {
    const srcComponent = entity.sound;
    const srcSlots = srcComponent.slots;

    // convert 'slots' back to
    // simple option objects
    const slots = {};
    for (const key in srcSlots) {
      const srcSlot = srcSlots[key];
      slots[key] = {
        name: srcSlot.name,
        volume: srcSlot.volume,
        pitch: srcSlot.pitch,
        loop: srcSlot.loop,
        duration: srcSlot.duration,
        startTime: srcSlot.startTime,
        overlap: srcSlot.overlap,
        autoPlay: srcSlot.autoPlay,
        asset: srcSlot.asset
      };
    }
    const cloneData = {
      distanceModel: srcComponent.distanceModel,
      enabled: srcComponent.enabled,
      maxDistance: srcComponent.maxDistance,
      pitch: srcComponent.pitch,
      positional: srcComponent.positional,
      refDistance: srcComponent.refDistance,
      rollOffFactor: srcComponent.rollOffFactor,
      slots: slots,
      volume: srcComponent.volume
    };

    // add component with new data
    return this.addComponent(clone, cloneData);
  }
  onUpdate(dt) {
    const store = this.store;
    for (const id in store) {
      if (store.hasOwnProperty(id)) {
        const item = store[id];
        const entity = item.entity;
        if (entity.enabled) {
          const component = entity.sound;

          // Update slot position if this is a 3d sound
          if (component.enabled && component.positional) {
            const position = entity.getPosition();
            const slots = component.slots;
            for (const key in slots) {
              slots[key].updatePosition(position);
            }
          }
        }
      }
    }
  }
  onBeforeRemove(entity, component) {
    const slots = component.slots;
    // stop non overlapping sounds
    for (const key in slots) {
      if (!slots[key].overlap) {
        slots[key].stop();
      }
    }
    component.onRemove();
  }
  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);
  }
}
Component._buildAccessors(SoundComponent.prototype, _schema);

export { SoundComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc291bmQvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5cbmltcG9ydCB7IGhhc0F1ZGlvQ29udGV4dCB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2F1ZGlvL2NhcGFiaWxpdGllcy5qcyc7XG5cbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBDb21wb25lbnRTeXN0ZW0gfSBmcm9tICcuLi9zeXN0ZW0uanMnO1xuXG5pbXBvcnQgeyBTb3VuZENvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IFNvdW5kQ29tcG9uZW50RGF0YSB9IGZyb20gJy4vZGF0YS5qcyc7XG5cbmNvbnN0IF9zY2hlbWEgPSBbJ2VuYWJsZWQnXTtcblxuLyoqXG4gKiBNYW5hZ2VzIGNyZWF0aW9uIG9mIHtAbGluayBTb3VuZENvbXBvbmVudH1zLlxuICpcbiAqIEBhdWdtZW50cyBDb21wb25lbnRTeXN0ZW1cbiAqIEBjYXRlZ29yeSBTb3VuZFxuICovXG5jbGFzcyBTb3VuZENvbXBvbmVudFN5c3RlbSBleHRlbmRzIENvbXBvbmVudFN5c3RlbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgU291bmRDb21wb25lbnRTeXN0ZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBhcHAgLSBUaGUgQXBwbGljYXRpb24uXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuXG4gICAgICAgIHRoaXMuaWQgPSAnc291bmQnO1xuXG4gICAgICAgIHRoaXMuQ29tcG9uZW50VHlwZSA9IFNvdW5kQ29tcG9uZW50O1xuICAgICAgICB0aGlzLkRhdGFUeXBlID0gU291bmRDb21wb25lbnREYXRhO1xuXG4gICAgICAgIHRoaXMuc2NoZW1hID0gX3NjaGVtYTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0cyAvIHNldHMgdGhlIHNvdW5kIG1hbmFnZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtpbXBvcnQoJy4uLy4uLy4uL3BsYXRmb3JtL3NvdW5kL21hbmFnZXIuanMnKS5Tb3VuZE1hbmFnZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hbmFnZXIgPSBhcHAuc291bmRNYW5hZ2VyO1xuICAgICAgICBEZWJ1Zy5hc3NlcnQodGhpcy5tYW5hZ2VyLCBcIkF1ZGlvU291cmNlQ29tcG9uZW50U3lzdGVtIGNhbm5vdCBiZSBjcmVhdGVkIHdpdGhvdXQgc291bmQgbWFuYWdlclwiKTtcblxuICAgICAgICB0aGlzLmFwcC5zeXN0ZW1zLm9uKCd1cGRhdGUnLCB0aGlzLm9uVXBkYXRlLCB0aGlzKTtcblxuICAgICAgICB0aGlzLm9uKCdiZWZvcmVyZW1vdmUnLCB0aGlzLm9uQmVmb3JlUmVtb3ZlLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIC8gZ2V0cyB0aGUgdm9sdW1lIGZvciB0aGUgZW50aXJlIFNvdW5kIHN5c3RlbS4gQWxsIHNvdW5kcyB3aWxsIGhhdmUgdGhlaXIgdm9sdW1lXG4gICAgICogbXVsdGlwbGllZCBieSB0aGlzIHZhbHVlLiBWYWxpZCBiZXR3ZWVuIFswLCAxXS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgc2V0IHZvbHVtZSh2b2x1bWUpIHtcbiAgICAgICAgdGhpcy5tYW5hZ2VyLnZvbHVtZSA9IHZvbHVtZTtcbiAgICB9XG5cbiAgICBnZXQgdm9sdW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tYW5hZ2VyLnZvbHVtZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBBdWRpb0NvbnRleHQgY3VycmVudGx5IHVzZWQgYnkgdGhlIHNvdW5kIG1hbmFnZXIuIFJlcXVpcmVzIFdlYiBBdWRpbyBBUEkgc3VwcG9ydC5cbiAgICAgKiBSZXR1cm5zIG51bGwgaWYgdGhlIGRldmljZSBkb2VzIG5vdCBzdXBwb3J0IHRoZSBXZWIgQXVkaW8gQVBJLlxuICAgICAqXG4gICAgICogQHR5cGUge0F1ZGlvQ29udGV4dHxudWxsfVxuICAgICAqL1xuICAgIGdldCBjb250ZXh0KCkge1xuICAgICAgICBpZiAoIWhhc0F1ZGlvQ29udGV4dCgpKSB7XG4gICAgICAgICAgICBEZWJ1Zy53YXJuKCdXQVJOSU5HOiBBdWRpbyBjb250ZXh0IGlzIG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBicm93c2VyJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLm1hbmFnZXIuY29udGV4dDtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgcHJvcGVydGllcyA9IFtcbiAgICAgICAgICAgICd2b2x1bWUnLFxuICAgICAgICAgICAgJ3BpdGNoJyxcbiAgICAgICAgICAgICdwb3NpdGlvbmFsJyxcbiAgICAgICAgICAgICdyZWZEaXN0YW5jZScsXG4gICAgICAgICAgICAnbWF4RGlzdGFuY2UnLFxuICAgICAgICAgICAgJ3JvbGxPZmZGYWN0b3InLFxuICAgICAgICAgICAgJ2Rpc3RhbmNlTW9kZWwnLFxuICAgICAgICAgICAgJ3Nsb3RzJ1xuICAgICAgICBdO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvcGVydGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkocHJvcGVydGllc1tpXSkpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRbcHJvcGVydGllc1tpXV0gPSBkYXRhW3Byb3BlcnRpZXNbaV1dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBbJ2VuYWJsZWQnXSk7XG4gICAgfVxuXG4gICAgY2xvbmVDb21wb25lbnQoZW50aXR5LCBjbG9uZSkge1xuICAgICAgICBjb25zdCBzcmNDb21wb25lbnQgPSBlbnRpdHkuc291bmQ7XG4gICAgICAgIGNvbnN0IHNyY1Nsb3RzID0gc3JjQ29tcG9uZW50LnNsb3RzO1xuXG4gICAgICAgIC8vIGNvbnZlcnQgJ3Nsb3RzJyBiYWNrIHRvXG4gICAgICAgIC8vIHNpbXBsZSBvcHRpb24gb2JqZWN0c1xuICAgICAgICBjb25zdCBzbG90cyA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBzcmNTbG90cykge1xuICAgICAgICAgICAgY29uc3Qgc3JjU2xvdCA9IHNyY1Nsb3RzW2tleV07XG4gICAgICAgICAgICBzbG90c1trZXldID0ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHNyY1Nsb3QubmFtZSxcbiAgICAgICAgICAgICAgICB2b2x1bWU6IHNyY1Nsb3Qudm9sdW1lLFxuICAgICAgICAgICAgICAgIHBpdGNoOiBzcmNTbG90LnBpdGNoLFxuICAgICAgICAgICAgICAgIGxvb3A6IHNyY1Nsb3QubG9vcCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogc3JjU2xvdC5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBzdGFydFRpbWU6IHNyY1Nsb3Quc3RhcnRUaW1lLFxuICAgICAgICAgICAgICAgIG92ZXJsYXA6IHNyY1Nsb3Qub3ZlcmxhcCxcbiAgICAgICAgICAgICAgICBhdXRvUGxheTogc3JjU2xvdC5hdXRvUGxheSxcbiAgICAgICAgICAgICAgICBhc3NldDogc3JjU2xvdC5hc3NldFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsb25lRGF0YSA9IHtcbiAgICAgICAgICAgIGRpc3RhbmNlTW9kZWw6IHNyY0NvbXBvbmVudC5kaXN0YW5jZU1vZGVsLFxuICAgICAgICAgICAgZW5hYmxlZDogc3JjQ29tcG9uZW50LmVuYWJsZWQsXG4gICAgICAgICAgICBtYXhEaXN0YW5jZTogc3JjQ29tcG9uZW50Lm1heERpc3RhbmNlLFxuICAgICAgICAgICAgcGl0Y2g6IHNyY0NvbXBvbmVudC5waXRjaCxcbiAgICAgICAgICAgIHBvc2l0aW9uYWw6IHNyY0NvbXBvbmVudC5wb3NpdGlvbmFsLFxuICAgICAgICAgICAgcmVmRGlzdGFuY2U6IHNyY0NvbXBvbmVudC5yZWZEaXN0YW5jZSxcbiAgICAgICAgICAgIHJvbGxPZmZGYWN0b3I6IHNyY0NvbXBvbmVudC5yb2xsT2ZmRmFjdG9yLFxuICAgICAgICAgICAgc2xvdHM6IHNsb3RzLFxuICAgICAgICAgICAgdm9sdW1lOiBzcmNDb21wb25lbnQudm9sdW1lXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYWRkIGNvbXBvbmVudCB3aXRoIG5ldyBkYXRhXG4gICAgICAgIHJldHVybiB0aGlzLmFkZENvbXBvbmVudChjbG9uZSwgY2xvbmVEYXRhKTtcbiAgICB9XG5cbiAgICBvblVwZGF0ZShkdCkge1xuICAgICAgICBjb25zdCBzdG9yZSA9IHRoaXMuc3RvcmU7XG5cbiAgICAgICAgZm9yIChjb25zdCBpZCBpbiBzdG9yZSkge1xuICAgICAgICAgICAgaWYgKHN0b3JlLmhhc093blByb3BlcnR5KGlkKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBzdG9yZVtpZF07XG4gICAgICAgICAgICAgICAgY29uc3QgZW50aXR5ID0gaXRlbS5lbnRpdHk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZW50aXR5LmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZW50aXR5LnNvdW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBzbG90IHBvc2l0aW9uIGlmIHRoaXMgaXMgYSAzZCBzb3VuZFxuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50LmVuYWJsZWQgJiYgY29tcG9uZW50LnBvc2l0aW9uYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gZW50aXR5LmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzbG90cyA9IGNvbXBvbmVudC5zbG90cztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xvdHNba2V5XS51cGRhdGVQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkJlZm9yZVJlbW92ZShlbnRpdHksIGNvbXBvbmVudCkge1xuICAgICAgICBjb25zdCBzbG90cyA9IGNvbXBvbmVudC5zbG90cztcbiAgICAgICAgLy8gc3RvcCBub24gb3ZlcmxhcHBpbmcgc291bmRzXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XG4gICAgICAgICAgICBpZiAoIXNsb3RzW2tleV0ub3ZlcmxhcCkge1xuICAgICAgICAgICAgICAgIHNsb3RzW2tleV0uc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29tcG9uZW50Lm9uUmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xuXG4gICAgICAgIHRoaXMuYXBwLnN5c3RlbXMub2ZmKCd1cGRhdGUnLCB0aGlzLm9uVXBkYXRlLCB0aGlzKTtcbiAgICB9XG59XG5cbkNvbXBvbmVudC5fYnVpbGRBY2Nlc3NvcnMoU291bmRDb21wb25lbnQucHJvdG90eXBlLCBfc2NoZW1hKTtcblxuZXhwb3J0IHsgU291bmRDb21wb25lbnRTeXN0ZW0gfTtcbiJdLCJuYW1lcyI6WyJfc2NoZW1hIiwiU291bmRDb21wb25lbnRTeXN0ZW0iLCJDb21wb25lbnRTeXN0ZW0iLCJjb25zdHJ1Y3RvciIsImFwcCIsImlkIiwiQ29tcG9uZW50VHlwZSIsIlNvdW5kQ29tcG9uZW50IiwiRGF0YVR5cGUiLCJTb3VuZENvbXBvbmVudERhdGEiLCJzY2hlbWEiLCJtYW5hZ2VyIiwic291bmRNYW5hZ2VyIiwiRGVidWciLCJhc3NlcnQiLCJzeXN0ZW1zIiwib24iLCJvblVwZGF0ZSIsIm9uQmVmb3JlUmVtb3ZlIiwidm9sdW1lIiwiY29udGV4dCIsImhhc0F1ZGlvQ29udGV4dCIsIndhcm4iLCJpbml0aWFsaXplQ29tcG9uZW50RGF0YSIsImNvbXBvbmVudCIsImRhdGEiLCJwcm9wZXJ0aWVzIiwiaSIsImxlbmd0aCIsImhhc093blByb3BlcnR5IiwiY2xvbmVDb21wb25lbnQiLCJlbnRpdHkiLCJjbG9uZSIsInNyY0NvbXBvbmVudCIsInNvdW5kIiwic3JjU2xvdHMiLCJzbG90cyIsImtleSIsInNyY1Nsb3QiLCJuYW1lIiwicGl0Y2giLCJsb29wIiwiZHVyYXRpb24iLCJzdGFydFRpbWUiLCJvdmVybGFwIiwiYXV0b1BsYXkiLCJhc3NldCIsImNsb25lRGF0YSIsImRpc3RhbmNlTW9kZWwiLCJlbmFibGVkIiwibWF4RGlzdGFuY2UiLCJwb3NpdGlvbmFsIiwicmVmRGlzdGFuY2UiLCJyb2xsT2ZmRmFjdG9yIiwiYWRkQ29tcG9uZW50IiwiZHQiLCJzdG9yZSIsIml0ZW0iLCJwb3NpdGlvbiIsImdldFBvc2l0aW9uIiwidXBkYXRlUG9zaXRpb24iLCJzdG9wIiwib25SZW1vdmUiLCJkZXN0cm95Iiwib2ZmIiwiQ29tcG9uZW50IiwiX2J1aWxkQWNjZXNzb3JzIiwicHJvdG90eXBlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBVUEsTUFBTUEsT0FBTyxH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
