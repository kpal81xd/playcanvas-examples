import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { ScrollViewComponent } from './component.js';
import { ScrollViewComponentData } from './data.js';
import { Vec2 } from '../../../core/math/vec2.js';

const _schema = [{
  name: 'enabled',
  type: 'boolean'
}, {
  name: 'horizontal',
  type: 'boolean'
}, {
  name: 'vertical',
  type: 'boolean'
}, {
  name: 'scrollMode',
  type: 'number'
}, {
  name: 'bounceAmount',
  type: 'number'
}, {
  name: 'friction',
  type: 'number'
}, {
  name: 'dragThreshold',
  type: 'number'
}, {
  name: 'useMouseWheel',
  type: 'boolean'
}, {
  name: 'mouseWheelSensitivity',
  type: 'vec2'
}, {
  name: 'horizontalScrollbarVisibility',
  type: 'number'
}, {
  name: 'verticalScrollbarVisibility',
  type: 'number'
}, {
  name: 'viewportEntity',
  type: 'entity'
}, {
  name: 'contentEntity',
  type: 'entity'
}, {
  name: 'horizontalScrollbarEntity',
  type: 'entity'
}, {
  name: 'verticalScrollbarEntity',
  type: 'entity'
}];
const DEFAULT_DRAG_THRESHOLD = 10;

/**
 * Manages creation of {@link ScrollViewComponent}s.
 *
 * @augments ComponentSystem
 * @category User Interface
 */
class ScrollViewComponentSystem extends ComponentSystem {
  /**
   * Create a new ScrollViewComponentSystem instance.
   *
   * @param {import('../../app-base.js').AppBase} app - The application.
   * @hideconstructor
   */
  constructor(app) {
    super(app);
    this.id = 'scrollview';
    this.ComponentType = ScrollViewComponent;
    this.DataType = ScrollViewComponentData;
    this.schema = _schema;
    this.on('beforeremove', this._onRemoveComponent, this);
    this.app.systems.on('update', this.onUpdate, this);
  }
  initializeComponentData(component, data, properties) {
    if (data.dragThreshold === undefined) {
      data.dragThreshold = DEFAULT_DRAG_THRESHOLD;
    }
    if (data.useMouseWheel === undefined) {
      data.useMouseWheel = true;
    }
    if (data.mouseWheelSensitivity === undefined) {
      data.mouseWheelSensitivity = new Vec2(1, 1);
    }
    super.initializeComponentData(component, data, _schema);
  }
  onUpdate(dt) {
    const components = this.store;
    for (const id in components) {
      const entity = components[id].entity;
      const component = entity.scrollview;
      if (component.enabled && entity.enabled) {
        component.onUpdate();
      }
    }
  }
  _onRemoveComponent(entity, component) {
    component.onRemove();
  }
  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);
  }
}
Component._buildAccessors(ScrollViewComponent.prototype, _schema);

export { ScrollViewComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc2Nyb2xsLXZpZXcvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBDb21wb25lbnRTeXN0ZW0gfSBmcm9tICcuLi9zeXN0ZW0uanMnO1xuXG5pbXBvcnQgeyBTY3JvbGxWaWV3Q29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQuanMnO1xuaW1wb3J0IHsgU2Nyb2xsVmlld0NvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG5pbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9tYXRoL3ZlYzIuanMnO1xuXG5jb25zdCBfc2NoZW1hID0gW1xuICAgIHsgbmFtZTogJ2VuYWJsZWQnLCB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICB7IG5hbWU6ICdob3Jpem9udGFsJywgdHlwZTogJ2Jvb2xlYW4nIH0sXG4gICAgeyBuYW1lOiAndmVydGljYWwnLCB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICB7IG5hbWU6ICdzY3JvbGxNb2RlJywgdHlwZTogJ251bWJlcicgfSxcbiAgICB7IG5hbWU6ICdib3VuY2VBbW91bnQnLCB0eXBlOiAnbnVtYmVyJyB9LFxuICAgIHsgbmFtZTogJ2ZyaWN0aW9uJywgdHlwZTogJ251bWJlcicgfSxcbiAgICB7IG5hbWU6ICdkcmFnVGhyZXNob2xkJywgdHlwZTogJ251bWJlcicgfSxcbiAgICB7IG5hbWU6ICd1c2VNb3VzZVdoZWVsJywgdHlwZTogJ2Jvb2xlYW4nIH0sXG4gICAgeyBuYW1lOiAnbW91c2VXaGVlbFNlbnNpdGl2aXR5JywgdHlwZTogJ3ZlYzInIH0sXG4gICAgeyBuYW1lOiAnaG9yaXpvbnRhbFNjcm9sbGJhclZpc2liaWxpdHknLCB0eXBlOiAnbnVtYmVyJyB9LFxuICAgIHsgbmFtZTogJ3ZlcnRpY2FsU2Nyb2xsYmFyVmlzaWJpbGl0eScsIHR5cGU6ICdudW1iZXInIH0sXG4gICAgeyBuYW1lOiAndmlld3BvcnRFbnRpdHknLCB0eXBlOiAnZW50aXR5JyB9LFxuICAgIHsgbmFtZTogJ2NvbnRlbnRFbnRpdHknLCB0eXBlOiAnZW50aXR5JyB9LFxuICAgIHsgbmFtZTogJ2hvcml6b250YWxTY3JvbGxiYXJFbnRpdHknLCB0eXBlOiAnZW50aXR5JyB9LFxuICAgIHsgbmFtZTogJ3ZlcnRpY2FsU2Nyb2xsYmFyRW50aXR5JywgdHlwZTogJ2VudGl0eScgfVxuXTtcblxuY29uc3QgREVGQVVMVF9EUkFHX1RIUkVTSE9MRCA9IDEwO1xuXG4vKipcbiAqIE1hbmFnZXMgY3JlYXRpb24gb2Yge0BsaW5rIFNjcm9sbFZpZXdDb21wb25lbnR9cy5cbiAqXG4gKiBAYXVnbWVudHMgQ29tcG9uZW50U3lzdGVtXG4gKiBAY2F0ZWdvcnkgVXNlciBJbnRlcmZhY2VcbiAqL1xuY2xhc3MgU2Nyb2xsVmlld0NvbXBvbmVudFN5c3RlbSBleHRlbmRzIENvbXBvbmVudFN5c3RlbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFNjcm9sbFZpZXdDb21wb25lbnRTeXN0ZW0gaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBhcHAgLSBUaGUgYXBwbGljYXRpb24uXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuXG4gICAgICAgIHRoaXMuaWQgPSAnc2Nyb2xsdmlldyc7XG5cbiAgICAgICAgdGhpcy5Db21wb25lbnRUeXBlID0gU2Nyb2xsVmlld0NvbXBvbmVudDtcbiAgICAgICAgdGhpcy5EYXRhVHlwZSA9IFNjcm9sbFZpZXdDb21wb25lbnREYXRhO1xuXG4gICAgICAgIHRoaXMuc2NoZW1hID0gX3NjaGVtYTtcblxuICAgICAgICB0aGlzLm9uKCdiZWZvcmVyZW1vdmUnLCB0aGlzLl9vblJlbW92ZUNvbXBvbmVudCwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vbigndXBkYXRlJywgdGhpcy5vblVwZGF0ZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIGlmIChkYXRhLmRyYWdUaHJlc2hvbGQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZGF0YS5kcmFnVGhyZXNob2xkID0gREVGQVVMVF9EUkFHX1RIUkVTSE9MRDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YS51c2VNb3VzZVdoZWVsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRhdGEudXNlTW91c2VXaGVlbCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEubW91c2VXaGVlbFNlbnNpdGl2aXR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRhdGEubW91c2VXaGVlbFNlbnNpdGl2aXR5ID0gbmV3IFZlYzIoMSwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlci5pbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEsIF9zY2hlbWEpO1xuICAgIH1cblxuICAgIG9uVXBkYXRlKGR0KSB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSB0aGlzLnN0b3JlO1xuXG4gICAgICAgIGZvciAoY29uc3QgaWQgaW4gY29tcG9uZW50cykge1xuICAgICAgICAgICAgY29uc3QgZW50aXR5ID0gY29tcG9uZW50c1tpZF0uZW50aXR5O1xuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZW50aXR5LnNjcm9sbHZpZXc7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50LmVuYWJsZWQgJiYgZW50aXR5LmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQub25VcGRhdGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX29uUmVtb3ZlQ29tcG9uZW50KGVudGl0eSwgY29tcG9uZW50KSB7XG4gICAgICAgIGNvbXBvbmVudC5vblJlbW92ZSgpO1xuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcblxuICAgICAgICB0aGlzLmFwcC5zeXN0ZW1zLm9mZigndXBkYXRlJywgdGhpcy5vblVwZGF0ZSwgdGhpcyk7XG4gICAgfVxufVxuXG5Db21wb25lbnQuX2J1aWxkQWNjZXNzb3JzKFNjcm9sbFZpZXdDb21wb25lbnQucHJvdG90eXBlLCBfc2NoZW1hKTtcblxuZXhwb3J0IHsgU2Nyb2xsVmlld0NvbXBvbmVudFN5c3RlbSB9O1xuIl0sIm5hbWVzIjpbIl9zY2hlbWEiLCJuYW1lIiwidHlwZSIsIkRFRkFVTFRfRFJBR19USFJFU0hPTEQiLCJTY3JvbGxWaWV3Q29tcG9uZW50U3lzdGVtIiwiQ29tcG9uZW50U3lzdGVtIiwiY29uc3RydWN0b3IiLCJhcHAiLCJpZCIsIkNvbXBvbmVudFR5cGUiLCJTY3JvbGxWaWV3Q29tcG9uZW50IiwiRGF0YVR5cGUiLCJTY3JvbGxWaWV3Q29tcG9uZW50RGF0YSIsInNjaGVtYSIsIm9uIiwiX29uUmVtb3ZlQ29tcG9uZW50Iiwic3lzdGVtcyIsIm9uVXBkYXRlIiwiaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEiLCJjb21wb25lbnQiLCJkYXRhIiwicHJvcGVydGllcyIsImRyYWdUaHJlc2hvbGQiLCJ1bmRlZmluZWQiLCJ1c2VNb3VzZVdoZWVsIiwibW91c2VXaGVlbFNlbnNpdGl2aXR5IiwiVmVjMiIsImR0IiwiY29tcG9uZW50cyIsInN0b3JlIiwiZW50aXR5Iiwic2Nyb2xsdmlldyIsImVuYWJsZWQiLCJvblJlbW92ZSIsImRlc3Ryb3kiLCJvZmYiLCJDb21wb25lbnQiLCJfYnVpbGRBY2Nlc3NvcnMiLCJwcm90b3R5cGUiXSwibWFw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
