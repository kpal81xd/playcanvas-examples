import { DebugHelper } from '../../../core/debug.js';
import { DebugGraphics } from '../debug-graphics.js';
import { DynamicBuffers } from '../dynamic-buffers.js';
import { WebgpuDynamicBuffer } from './webgpu-dynamic-buffer.js';

class WebgpuDynamicBuffers extends DynamicBuffers {
  constructor(...args) {
    super(...args);
    /**
     * Staging buffers which are getting copied over to gpu buffers in the the command buffer waiting
     * to be submitted. When those command buffers are submitted, we can mapAsync these staging
     * buffers for reuse.
     *
     * @type {WebgpuDynamicBuffer[]}
     */
    this.pendingStagingBuffers = [];
  }
  createBuffer(device, size, isStaging) {
    return new WebgpuDynamicBuffer(device, size, isStaging);
  }

  /**
   * Submit all used buffers to the device.
   */
  submit() {
    super.submit();

    // submit all used buffers
    const count = this.usedBuffers.length;
    if (count) {
      const device = this.device;
      const gpuBuffers = this.gpuBuffers;

      // new command encoder, as buffer copies need to be submitted before the currently recorded
      // rendering encoder is submitted
      const commandEncoder = device.wgpu.createCommandEncoder();
      DebugHelper.setLabel(commandEncoder, 'DynamicBuffersSubmit');
      DebugGraphics.pushGpuMarker(device, 'DynamicBuffersSubmit');

      // run this loop backwards to preserve the order of buffers in gpuBuffers array
      for (let i = count - 1; i >= 0; i--) {
        const usedBuffer = this.usedBuffers[i];
        const {
          stagingBuffer,
          gpuBuffer,
          offset,
          size
        } = usedBuffer;

        // unmap staging buffer (we're done writing to it on CPU)
        const src = stagingBuffer.buffer;
        src.unmap();

        // schedule data copy from staging to gpu buffer
        commandEncoder.copyBufferToBuffer(src, offset, gpuBuffer.buffer, offset, size);

        // gpu buffer can be reused immediately
        gpuBuffers.push(gpuBuffer);
      }
      DebugGraphics.popGpuMarker(device);

      // schedule the command buffer to run before all currently scheduled command buffers
      const cb = commandEncoder.finish();
      DebugHelper.setLabel(cb, 'DynamicBuffers');
      device.addCommandBuffer(cb, true);

      // keep the used staging buffers in the pending list
      for (let i = 0; i < count; i++) {
        const stagingBuffer = this.usedBuffers[i].stagingBuffer;
        this.pendingStagingBuffers.push(stagingBuffer);
      }
      this.usedBuffers.length = 0;
    }
  }

  /**
   * Called when all scheduled command buffers are submitted to the device.
   */
  onCommandBuffersSubmitted() {
    // map the staging buffers for write to alow them to be reused - this resolves when the CBs
    // using them are done on the GPU
    const count = this.pendingStagingBuffers.length;
    if (count) {
      for (let i = 0; i < count; i++) {
        const stagingBuffer = this.pendingStagingBuffers[i];
        stagingBuffer.buffer.mapAsync(GPUMapMode.WRITE).then(() => {
          // the buffer can be mapped after the device has been destroyed, so test for that
          if (this.stagingBuffers) {
            stagingBuffer.onAvailable();
            this.stagingBuffers.push(stagingBuffer);
          }
        });
      }
      this.pendingStagingBuffers.length = 0;
    }
  }
}

export { WebgpuDynamicBuffers };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ3B1LWR5bmFtaWMtYnVmZmVycy5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsYXRmb3JtL2dyYXBoaWNzL3dlYmdwdS93ZWJncHUtZHluYW1pYy1idWZmZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnSGVscGVyIH0gZnJvbSBcIi4uLy4uLy4uL2NvcmUvZGVidWcuanNcIjtcbmltcG9ydCB7IERlYnVnR3JhcGhpY3MgfSBmcm9tIFwiLi4vZGVidWctZ3JhcGhpY3MuanNcIjtcbmltcG9ydCB7IER5bmFtaWNCdWZmZXJzIH0gZnJvbSBcIi4uL2R5bmFtaWMtYnVmZmVycy5qc1wiO1xuaW1wb3J0IHsgV2ViZ3B1RHluYW1pY0J1ZmZlciB9IGZyb20gXCIuL3dlYmdwdS1keW5hbWljLWJ1ZmZlci5qc1wiO1xuXG5jbGFzcyBXZWJncHVEeW5hbWljQnVmZmVycyBleHRlbmRzIER5bmFtaWNCdWZmZXJzIHtcbiAgICAvKipcbiAgICAgKiBTdGFnaW5nIGJ1ZmZlcnMgd2hpY2ggYXJlIGdldHRpbmcgY29waWVkIG92ZXIgdG8gZ3B1IGJ1ZmZlcnMgaW4gdGhlIHRoZSBjb21tYW5kIGJ1ZmZlciB3YWl0aW5nXG4gICAgICogdG8gYmUgc3VibWl0dGVkLiBXaGVuIHRob3NlIGNvbW1hbmQgYnVmZmVycyBhcmUgc3VibWl0dGVkLCB3ZSBjYW4gbWFwQXN5bmMgdGhlc2Ugc3RhZ2luZ1xuICAgICAqIGJ1ZmZlcnMgZm9yIHJldXNlLlxuICAgICAqXG4gICAgICogQHR5cGUge1dlYmdwdUR5bmFtaWNCdWZmZXJbXX1cbiAgICAgKi9cbiAgICBwZW5kaW5nU3RhZ2luZ0J1ZmZlcnMgPSBbXTtcblxuICAgIGNyZWF0ZUJ1ZmZlcihkZXZpY2UsIHNpemUsIGlzU3RhZ2luZykge1xuICAgICAgICByZXR1cm4gbmV3IFdlYmdwdUR5bmFtaWNCdWZmZXIoZGV2aWNlLCBzaXplLCBpc1N0YWdpbmcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN1Ym1pdCBhbGwgdXNlZCBidWZmZXJzIHRvIHRoZSBkZXZpY2UuXG4gICAgICovXG4gICAgc3VibWl0KCkge1xuXG4gICAgICAgIHN1cGVyLnN1Ym1pdCgpO1xuXG4gICAgICAgIC8vIHN1Ym1pdCBhbGwgdXNlZCBidWZmZXJzXG4gICAgICAgIGNvbnN0IGNvdW50ID0gdGhpcy51c2VkQnVmZmVycy5sZW5ndGg7XG4gICAgICAgIGlmIChjb3VudCkge1xuXG4gICAgICAgICAgICBjb25zdCBkZXZpY2UgPSB0aGlzLmRldmljZTtcbiAgICAgICAgICAgIGNvbnN0IGdwdUJ1ZmZlcnMgPSB0aGlzLmdwdUJ1ZmZlcnM7XG5cbiAgICAgICAgICAgIC8vIG5ldyBjb21tYW5kIGVuY29kZXIsIGFzIGJ1ZmZlciBjb3BpZXMgbmVlZCB0byBiZSBzdWJtaXR0ZWQgYmVmb3JlIHRoZSBjdXJyZW50bHkgcmVjb3JkZWRcbiAgICAgICAgICAgIC8vIHJlbmRlcmluZyBlbmNvZGVyIGlzIHN1Ym1pdHRlZFxuICAgICAgICAgICAgY29uc3QgY29tbWFuZEVuY29kZXIgPSBkZXZpY2Uud2dwdS5jcmVhdGVDb21tYW5kRW5jb2RlcigpO1xuICAgICAgICAgICAgRGVidWdIZWxwZXIuc2V0TGFiZWwoY29tbWFuZEVuY29kZXIsICdEeW5hbWljQnVmZmVyc1N1Ym1pdCcpO1xuXG4gICAgICAgICAgICBEZWJ1Z0dyYXBoaWNzLnB1c2hHcHVNYXJrZXIoZGV2aWNlLCAnRHluYW1pY0J1ZmZlcnNTdWJtaXQnKTtcblxuICAgICAgICAgICAgLy8gcnVuIHRoaXMgbG9vcCBiYWNrd2FyZHMgdG8gcHJlc2VydmUgdGhlIG9yZGVyIG9mIGJ1ZmZlcnMgaW4gZ3B1QnVmZmVycyBhcnJheVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGNvdW50IC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VkQnVmZmVyID0gdGhpcy51c2VkQnVmZmVyc1tpXTtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0YWdpbmdCdWZmZXIsIGdwdUJ1ZmZlciwgb2Zmc2V0LCBzaXplIH0gPSB1c2VkQnVmZmVyO1xuXG4gICAgICAgICAgICAgICAgLy8gdW5tYXAgc3RhZ2luZyBidWZmZXIgKHdlJ3JlIGRvbmUgd3JpdGluZyB0byBpdCBvbiBDUFUpXG4gICAgICAgICAgICAgICAgY29uc3Qgc3JjID0gc3RhZ2luZ0J1ZmZlci5idWZmZXI7XG4gICAgICAgICAgICAgICAgc3JjLnVubWFwKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBzY2hlZHVsZSBkYXRhIGNvcHkgZnJvbSBzdGFnaW5nIHRvIGdwdSBidWZmZXJcbiAgICAgICAgICAgICAgICBjb21tYW5kRW5jb2Rlci5jb3B5QnVmZmVyVG9CdWZmZXIoc3JjLCBvZmZzZXQsIGdwdUJ1ZmZlci5idWZmZXIsIG9mZnNldCwgc2l6ZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBncHUgYnVmZmVyIGNhbiBiZSByZXVzZWQgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgICAgICBncHVCdWZmZXJzLnB1c2goZ3B1QnVmZmVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgRGVidWdHcmFwaGljcy5wb3BHcHVNYXJrZXIoZGV2aWNlKTtcblxuICAgICAgICAgICAgLy8gc2NoZWR1bGUgdGhlIGNvbW1hbmQgYnVmZmVyIHRvIHJ1biBiZWZvcmUgYWxsIGN1cnJlbnRseSBzY2hlZHVsZWQgY29tbWFuZCBidWZmZXJzXG4gICAgICAgICAgICBjb25zdCBjYiA9IGNvbW1hbmRFbmNvZGVyLmZpbmlzaCgpO1xuICAgICAgICAgICAgRGVidWdIZWxwZXIuc2V0TGFiZWwoY2IsICdEeW5hbWljQnVmZmVycycpO1xuICAgICAgICAgICAgZGV2aWNlLmFkZENvbW1hbmRCdWZmZXIoY2IsIHRydWUpO1xuXG4gICAgICAgICAgICAvLyBrZWVwIHRoZSB1c2VkIHN0YWdpbmcgYnVmZmVycyBpbiB0aGUgcGVuZGluZyBsaXN0XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFnaW5nQnVmZmVyID0gdGhpcy51c2VkQnVmZmVyc1tpXS5zdGFnaW5nQnVmZmVyO1xuICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ1N0YWdpbmdCdWZmZXJzLnB1c2goc3RhZ2luZ0J1ZmZlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVzZWRCdWZmZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2hlbiBhbGwgc2NoZWR1bGVkIGNvbW1hbmQgYnVmZmVycyBhcmUgc3VibWl0dGVkIHRvIHRoZSBkZXZpY2UuXG4gICAgICovXG4gICAgb25Db21tYW5kQnVmZmVyc1N1Ym1pdHRlZCgpIHtcbiAgICAgICAgLy8gbWFwIHRoZSBzdGFnaW5nIGJ1ZmZlcnMgZm9yIHdyaXRlIHRvIGFsb3cgdGhlbSB0byBiZSByZXVzZWQgLSB0aGlzIHJlc29sdmVzIHdoZW4gdGhlIENCc1xuICAgICAgICAvLyB1c2luZyB0aGVtIGFyZSBkb25lIG9uIHRoZSBHUFVcbiAgICAgICAgY29uc3QgY291bnQgPSB0aGlzLnBlbmRpbmdTdGFnaW5nQnVmZmVycy5sZW5ndGg7XG4gICAgICAgIGlmIChjb3VudCkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhZ2luZ0J1ZmZlciA9IHRoaXMucGVuZGluZ1N0YWdpbmdCdWZmZXJzW2ldO1xuICAgICAgICAgICAgICAgIHN0YWdpbmdCdWZmZXIuYnVmZmVyLm1hcEFzeW5jKEdQVU1hcE1vZGUuV1JJVEUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgYnVmZmVyIGNhbiBiZSBtYXBwZWQgYWZ0ZXIgdGhlIGRldmljZSBoYXMgYmVlbiBkZXN0cm95ZWQsIHNvIHRlc3QgZm9yIHRoYXRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhZ2luZ0J1ZmZlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdpbmdCdWZmZXIub25BdmFpbGFibGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhZ2luZ0J1ZmZlcnMucHVzaChzdGFnaW5nQnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wZW5kaW5nU3RhZ2luZ0J1ZmZlcnMubGVuZ3RoID0gMDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgV2ViZ3B1RHluYW1pY0J1ZmZlcnMgfTtcbiJdLCJuYW1lcyI6WyJXZWJncHVEeW5hbWljQnVmZmVycyIsIkR5bmFtaWNCdWZmZXJzIiwiY29uc3RydWN0b3IiLCJhcmdzIiwicGVuZGluZ1N0YWdpbmdCdWZmZXJzIiwiY3JlYXRlQnVmZmVyIiwiZGV2aWNlIiwic2l6ZSIsImlzU3RhZ2luZyIsIldlYmdwdUR5bmFtaWNCdWZmZXIiLCJzdWJtaXQiLCJjb3VudCIsInVzZWRCdWZmZXJzIiwibGVuZ3RoIiwiZ3B1QnVmZmVycyIsImNvbW1hbmRFbmNvZGVyIiwid2dwdSIsImNyZWF0ZUNvbW1hbmRFbmNvZGVyIiwiRGVidWdIZWxwZXIiLCJzZXRMYWJlbCIsIkRlYnVnR3JhcGhpY3MiLCJwdXNoR3B1TWFya2VyIiwiaSIsInVzZWRCdWZmZXIiLCJzdGFnaW5nQnVmZmVyIiwiZ3B1QnVmZmVyIiwib2Zmc2V0Iiwic3JjIiwiYnVmZmVyIiwidW5tYXAiLCJjb3B5QnVmZmVyVG9CdWZmZXIiLCJwdXNoIiwicG9wR3B1TWFya2VyIiwiY2IiLCJmaW5pc2giLCJhZGRDb21tYW5kQnVmZmVyIiwib25Db21tYW5kQnVmZmVyc1N1Ym1pdHRlZCIsIm1hcEFzeW5jIiwiR1BVTWFwTW9kZSIsIldSSVRFIiwidGhlbiIsInN0YWdpbmdCdWZmZXJzIiwib25BdmFp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
